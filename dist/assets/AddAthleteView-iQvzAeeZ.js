import{a as h,A as m}from"./api-BJgnF3hB.js";import{T as b}from"./TrainerHeader-DWaHe2Wg.js";import{A as k}from"./AppAlert-jdCgL8S3.js";import{_ as A,c as n,e as p,a as t,f,d as c,k as v,v as _,t as u,b as g,F as w,j,o as i}from"./index-CZfNrfaq.js";const T={name:"AddAthleteView",components:{TrainerHeader:b,AppAlert:k},data(){return{athletes:[],loading:!0,error:null,searchQuery:"",addingAthletes:[],alert:{show:!1,type:"info",message:""},searchTimeout:null}},computed:{userFullName(){const r=JSON.parse(localStorage.getItem("user")||"{}");return`${r.first_name} ${r.last_name}`||"Trainer"},filteredAthletes(){if(!this.searchQuery.trim())return this.athletes;const r=this.searchQuery.toLowerCase();return this.athletes.filter(e=>e.first_name.toLowerCase().includes(r)||e.last_name.toLowerCase().includes(r)||e.email.toLowerCase().includes(r)||`${e.first_name} ${e.last_name}`.toLowerCase().includes(r))}},methods:{showAlert(r,e){this.alert={show:!0,type:r,message:e}},async fetchAthletes(){var r,e,d;this.loading=!0,this.error=null;try{const l=localStorage.getItem("access_token");if(!l){this.$router.push("/login");return}const s=await h.get(`${m.LOGIN.replace("/auth/login","")}/users/trainer/search-athletes`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});this.athletes=s.data.athletes||[]}catch(l){console.error("Error fetching athletes:",l),((r=l.response)==null?void 0:r.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((d=(e=l.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to load athletes"}finally{this.loading=!1}},debouncedSearch(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{console.log("Searching for:",this.searchQuery)},300)},async addAthlete(r){var e,d;this.addingAthletes.push(r.id);try{const l=localStorage.getItem("access_token"),s=await h.post(`${m.LOGIN.replace("/auth/login","")}/users/trainer/add-athlete`,{athlete_id:r.id},{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});this.showAlert("success",s.data.message||`${s.data.athlete_name} successfully added!`),this.athletes=this.athletes.filter(a=>a.id!==r.id),setTimeout(()=>{this.fetchAthletes()},2e3)}catch(l){console.error("Error adding athlete:",l),this.showAlert("error",((d=(e=l.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to add athlete")}finally{this.addingAthletes=this.addingAthletes.filter(l=>l!==r.id)}},clearSearch(){this.searchQuery=""},goToMyAthletes(){this.$router.push("/trainer/my-athletes")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchAthletes()}},S={class:"min-h-screen content-bg"},I={class:"container mx-auto px-4 py-6"},N={class:"welcome-section rounded-xl p-8 mb-8"},C={class:"flex justify-between items-center"},L={class:"search-card rounded-xl p-6 mb-6"},Q={class:"relative"},z={key:0,class:"text-center py-12"},V={key:1,class:"error-card rounded-xl p-8 text-center"},D={class:"text-gray-600 mb-4"},F={key:2,class:"space-y-4"},B={class:"flex items-center space-x-4"},P={class:"text-lg font-bold text-gray-800"},E={class:"text-gray-600"},M=["onClick","disabled"],O={key:0,class:"fas fa-spinner fa-spin mr-2"},H={key:1,class:"fas fa-user-plus mr-2"},G={key:0,class:"empty-state rounded-xl p-12 text-center"},q={class:"text-gray-500 mb-6"};function J(r,e,d,l,s,a){const y=f("TrainerHeader"),x=f("AppAlert");return i(),n("div",S,[p(y,{"user-full-name":a.userFullName,onLogout:a.logout},null,8,["user-full-name","onLogout"]),t("main",I,[t("div",N,[t("div",C,[e[7]||(e[7]=t("div",null,[t("h2",{class:"text-3xl font-bold text-white mb-2"}," Dodaj športnika "),t("p",{class:"text-white/90 text-lg"}," Išči in dodaj športnike za svoje ciklizacije. ")],-1)),t("button",{onClick:e[0]||(e[0]=(...o)=>a.goToMyAthletes&&a.goToMyAthletes(...o)),class:"back-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},e[6]||(e[6]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),c("Nazaj na moje špornike ")]))])]),t("div",L,[t("div",Q,[e[8]||(e[8]=t("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"},null,-1)),v(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>s.searchQuery=o),onInput:e[2]||(e[2]=(...o)=>a.debouncedSearch&&a.debouncedSearch(...o)),placeholder:"Išči športnika po imenu ali e-pošti...",class:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200"},null,544),[[_,s.searchQuery]])])]),s.loading?(i(),n("div",z,e[9]||(e[9]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1),t("p",{class:"text-white text-lg"},"Nalagam športnike",-1)]))):s.error?(i(),n("div",V,[e[11]||(e[11]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[12]||(e[12]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju športnikov",-1)),t("p",D,u(s.error),1),t("button",{onClick:e[3]||(e[3]=(...o)=>a.fetchAthletes&&a.fetchAthletes(...o)),class:"retry-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[10]||(e[10]=[t("i",{class:"fas fa-redo mr-2"},null,-1),c("Poskusi ponovno ")]))])):(i(),n("div",F,[(i(!0),n(w,null,j(a.filteredAthletes,o=>(i(),n("div",{key:o.id,class:"athlete-card rounded-xl p-6 flex justify-between items-center"},[t("div",B,[e[13]||(e[13]=t("div",{class:"athlete-avatar"},[t("i",{class:"fas fa-user-circle text-4xl text-gray-400"})],-1)),t("div",null,[t("h3",P,u(o.first_name)+" "+u(o.last_name),1),t("p",E,u(o.email),1)])]),t("button",{onClick:U=>a.addAthlete(o),disabled:s.addingAthletes.includes(o.id),class:"add-athlete-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},[s.addingAthletes.includes(o.id)?(i(),n("i",O)):(i(),n("i",H)),c(" "+u(s.addingAthletes.includes(o.id)?"Dodajanje...":"Dodaj športnika"),1)],8,M)]))),128)),a.filteredAthletes.length===0&&!s.loading?(i(),n("div",G,[e[15]||(e[15]=t("i",{class:"fas fa-users text-6xl text-gray-400 mb-4"},null,-1)),e[16]||(e[16]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Ni bilo najdenih špornikov.",-1)),t("p",q,u(s.searchQuery?"Poskusi dodati kriterije za iskanje športnika.":"Ni razpoložljivih športnikov za dodajanje."),1),s.searchQuery?(i(),n("button",{key:0,onClick:e[4]||(e[4]=(...o)=>a.clearSearch&&a.clearSearch(...o)),class:"clear-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[14]||(e[14]=[t("i",{class:"fas fa-times mr-2"},null,-1),c("Počisti iskalnik ")]))):g("",!0)])):g("",!0)]))]),p(x,{visible:s.alert.show,type:s.alert.type,message:s.alert.message,onClose:e[5]||(e[5]=o=>s.alert.show=!1)},null,8,["visible","type","message"])])}const Y=A(T,[["render",J],["__scopeId","data-v-ca567385"]]);export{Y as default};
