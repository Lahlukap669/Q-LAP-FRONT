import{a as w}from"./api-DUlGAOJP.js";import{_ as f,c,a as i,r as y,o as p,b,d as g,n as x,t as v,e as l,f as m,w as h,g as k,F as L}from"./index-Da2PU-7I.js";import{B as V}from"./BaseButton-IRkJBuG_.js";import{A as B}from"./AppAlert-CPz9EppH.js";const S={name:"LoginCard"},j={class:"min-h-screen content-bg flex items-center justify-center p-4"},A={class:"form-card rounded-xl overflow-hidden max-w-md w-full"},$={class:"form-content p-8"};function C(n,e,t,d,s,r){return p(),c("div",j,[i("div",A,[e[0]||(e[0]=i("div",{class:"header-bg p-8 text-center"},[i("h1",{class:"text-4xl font-bold text-white tracking-wider mb-2"},"Q-LAP"),i("p",{class:"text-white/90 text-sm"},"Quick Layered Annual Periodization")],-1)),i("div",$,[y(n.$slots,"default",{},void 0,!0)])])])}const F=f(S,[["render",C],["__scopeId","data-v-eb182f31"]]),I={name:"BaseInput",props:{id:String,type:{type:String,default:"text"},label:String,icon:String,placeholder:String,modelValue:String,disabled:Boolean,required:Boolean},emits:["update:modelValue"]},N={class:"mb-4"},P=["for"],q=["id","type","placeholder","value","disabled","required"];function z(n,e,t,d,s,r){return p(),c("div",N,[t.label?(p(),c("label",{key:0,for:t.id,class:"block text-gray-700 font-medium mb-2"},[t.icon?(p(),c("i",{key:0,class:x([t.icon,"mr-2 text-blue-500"])},null,2)):b("",!0),g(" "+v(t.label),1)],8,P)):b("",!0),i("input",{id:t.id,type:t.type,placeholder:t.placeholder,value:t.modelValue,onInput:e[0]||(e[0]=o=>n.$emit("update:modelValue",o.target.value)),disabled:t.disabled,required:t.required,class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-focus transition duration-200"},null,40,q)])}const U=f(I,[["render",z],["__scopeId","data-v-3463dffc"]]),E={name:"LoginForm",components:{BaseInput:U,BaseButton:V},props:{loading:Boolean},emits:["submit"],data(){return{form:{email:"",password:""}}},methods:{handleSubmit(){this.$emit("submit",this.form)}}};function M(n,e,t,d,s,r){const o=m("BaseInput"),u=m("BaseButton");return p(),c("form",{onSubmit:e[2]||(e[2]=k((...a)=>r.handleSubmit&&r.handleSubmit(...a),["prevent"])),class:"space-y-6"},[l(o,{id:"email",type:"email",label:"E-pošta",icon:"fas fa-user",placeholder:"Vnesi svoj e-poštni naslov",modelValue:s.form.email,"onUpdate:modelValue":e[0]||(e[0]=a=>s.form.email=a),disabled:t.loading,required:""},null,8,["modelValue","disabled"]),l(o,{id:"password",type:"password",label:"Geslo",icon:"fas fa-lock",placeholder:"Vnesi svoje geslo",modelValue:s.form.password,"onUpdate:modelValue":e[1]||(e[1]=a=>s.form.password=a),disabled:t.loading,required:""},null,8,["modelValue","disabled"]),l(u,{type:"submit",variant:"primary",loading:t.loading,disabled:t.loading},{default:h(()=>[g(v(t.loading?"Prijavljanje...":"Prijava"),1)]),_:1},8,["loading","disabled"])],32)}const Q=f(E,[["render",M]]),T={name:"LoginFooter"},G={class:"mt-6 text-center space-y-3"},J={class:"text-gray-600 text-sm"};function O(n,e,t,d,s,r){const o=m("router-link");return p(),c("div",G,[e[2]||(e[2]=i("div",null,[i("a",{href:"#",class:"text-blue-600 hover:text-blue-800 text-sm transition duration-200"}," Pozabljeno geslo? ")],-1)),i("div",J,[e[1]||(e[1]=g(" Še nimaš računa? ")),l(o,{to:"/register",class:"text-green-600 hover:text-green-800 font-semibold transition duration-200"},{default:h(()=>e[0]||(e[0]=[g(" Registracija ")])),_:1,__:[0]})])])}const R=f(T,[["render",O]]),D={name:"LoginView",components:{LoginCard:F,LoginForm:Q,LoginFooter:R,AppAlert:B},data(){return{loading:!1,alert:{show:!1,type:"info",message:""}}},methods:{showAlert(n,e){this.alert={show:!0,type:n,message:e}},async handleLogin(n){var e,t,d,s,r;this.loading=!0;try{const o=await w.post("/auth/login",{email:n.email,password:n.password}),{access_token:u,user:a,message:_}=o.data;localStorage.setItem("access_token",u),localStorage.setItem("user",JSON.stringify(a)),this.showAlert("success",_||"Uspešna prijava"),setTimeout(()=>{a.role===2?this.$router.push("/trainer"):a.role===1?this.$router.push("/athlete"):this.$router.push("/dashboard")},1500)}catch(o){if(console.error("Napaka pri prijavi:",o),((e=o.response)==null?void 0:e.status)===401)this.showAlert("error","Napačni podatki za prijavo.");else if(((t=o.response)==null?void 0:t.status)===400)this.showAlert("error",o.response.data.message||"Neveljaven zahtevek.");else if(((d=o.response)==null?void 0:d.status)>=500)this.showAlert("error","Napaka strežnika. Poskusi kasneje.");else{const u=((r=(s=o.response)==null?void 0:s.data)==null?void 0:r.message)||"Prijava neuspešna. Poskusi ponovno.";this.showAlert("error",u)}}finally{this.loading=!1}}}};function H(n,e,t,d,s,r){const o=m("LoginForm"),u=m("LoginFooter"),a=m("LoginCard"),_=m("AppAlert");return p(),c(L,null,[l(a,null,{default:h(()=>[l(o,{loading:s.loading,onSubmit:r.handleLogin},null,8,["loading","onSubmit"]),l(u)]),_:1}),l(_,{visible:s.alert.show,type:s.alert.type,message:s.alert.message,onClose:e[0]||(e[0]=K=>s.alert.show=!1)},null,8,["visible","type","message"])],64)}const ee=f(D,[["render",H]]);export{ee as default};
