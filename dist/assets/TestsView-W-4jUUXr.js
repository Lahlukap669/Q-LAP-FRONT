import{A as x,a as h}from"./api-DUlGAOJP.js";import{T as g}from"./TrainerHeader-Dx3V7vEH.js";import{_ as b,c as l,e as v,a as t,f as T,d as u,k as y,b as f,v as k,t as c,F as w,j as _,o as d}from"./index-Da2PU-7I.js";const N={name:"TestsView",components:{TrainerHeader:g},data(){return{tests:[],loading:!0,error:null,searchTerm:""}},computed:{userFullName(){const a=JSON.parse(localStorage.getItem("user")||"{}");return`${a.first_name} ${a.last_name}`||"Trainer"},filteredTests(){if(!this.searchTerm)return this.tests;const a=this.searchTerm.toLowerCase();return this.tests.filter(e=>{const o=e.athlete_full_name.toLowerCase().includes(a),n=this.formatDate(e.test_date).toLowerCase(),r=e.test_date.toLowerCase(),s=n.includes(a)||r.includes(a);return o||s})}},methods:{async fetchTests(){var a,e,o;this.loading=!0,this.error=null;try{const n=await h.get("/users/trainer/get-tests");this.tests=n.data.tests||[]}catch(n){console.error("Error fetching tests:",n),((a=n.response)==null?void 0:a.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Napaka pri nalaganju testov"}finally{this.loading=!1}},formatDate(a){return new Date(a).toLocaleDateString("sl-SI",{year:"numeric",month:"long",day:"numeric"})},clearSearch(){this.searchTerm=""},viewTest(a){this.$router.push(`/trainer/test/${a}`)},async deleteTest(a){var e,o,n;if(confirm("Želiš res izbrisati izbrani test?"))try{const r=await h.delete("/users/trainer/delete-test",{data:{test_id:a}});alert(r.data.message||"Test uspešno izbrisan"),this.fetchTests()}catch(r){console.error("Napaka pri brisanju testa:",r),((e=r.response)==null?void 0:e.status)===401?this.$router.push("/login"):alert(((n=(o=r.response)==null?void 0:o.data)==null?void 0:n.message)||"Napaka pri brisanju testa")}},createTest(){this.$router.push("/trainer/create-test")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")},async delete_test(a){var e,o,n,r;if(confirm("Želiš res izbrisati Test?"))try{const s=localStorage.getItem("access_token");if(!s){this.$router.push("/login");return}const m=await axios.delete(`${x.LOGIN.replace("/auth/login","")}/users/trainer/delete-test`,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},data:{test_id:a}});this.showAlert?this.showAlert("success",m.data.message||"test uspešno izbrisan"):alert(m.data.message||"test uspešno izbrisan"),await this.fetchTests()}catch(s){console.error("Error deleting periodization:",s),this.showAlert?this.showAlert("error",((o=(e=s.response)==null?void 0:e.data)==null?void 0:o.message)||"Napaka pri brisanju testa"):alert(((r=(n=s.response)==null?void 0:n.data)==null?void 0:r.message)||"Napaka pri brisanju testa")}}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchTests()}},S={class:"min-h-screen content-bg"},j={class:"container mx-auto px-4 py-6"},C={class:"search-section mb-8"},I={class:"search-container"},D={class:"search-input-wrapper"},z={key:0,class:"flex items-center justify-center min-h-[400px]"},L={key:1,class:"flex items-center justify-center min-h-[400px]"},A={class:"text-center bg-white rounded-xl p-8"},O={class:"text-gray-600 mb-4"},P={key:2,class:"space-y-6"},V={key:0,class:"search-results-info"},E={class:"text-white/90"},B={class:"flex items-center justify-between mb-4"},F={class:"text-2xl font-bold text-gray-800 mb-1"},H={class:"text-gray-600"},M={class:"test-details mb-6"},G={class:"flex items-center mb-3"},U={class:"ml-3"},J={class:"font-semibold text-gray-800"},K={class:"flex space-x-3"},R=["onClick"],q=["onClick"],Q={key:1,class:"empty-state text-center py-16"},W={key:2,class:"no-results text-center py-16"};function X(a,e,o,n,r,s){const m=T("TrainerHeader");return d(),l("div",S,[v(m,{"user-full-name":s.userFullName,onLogout:s.logout},null,8,["user-full-name","onLogout"]),t("main",j,[e[25]||(e[25]=t("div",{class:"text-center mb-8"},[t("h1",{class:"text-3xl font-bold text-white mb-2"},[t("i",{class:"fas fa-clipboard-list mr-3"}),u("POGLED NAD TESTI ")]),t("p",{class:"text-white/90"},"Pogled nad vsemi izvedenimi testi.")],-1)),t("div",C,[t("div",I,[t("div",D,[e[7]||(e[7]=t("i",{class:"fas fa-search search-icon"},null,-1)),y(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>r.searchTerm=i),placeholder:"Išči po športniku ali datumu (glej zapis datuma)...",class:"search-input"},null,512),[[k,r.searchTerm]]),r.searchTerm?(d(),l("button",{key:0,onClick:e[1]||(e[1]=(...i)=>s.clearSearch&&s.clearSearch(...i)),class:"clear-search-btn"},e[6]||(e[6]=[t("i",{class:"fas fa-times"},null,-1)]))):f("",!0)])])]),r.loading?(d(),l("div",z,e[8]||(e[8]=[t("div",{class:"text-center"},[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"}),t("p",{class:"text-white text-lg"},"Nalaganje testov...")],-1)]))):r.error?(d(),l("div",L,[t("div",A,[e[10]||(e[10]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[11]||(e[11]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju testov",-1)),t("p",O,c(r.error),1),t("button",{onClick:e[2]||(e[2]=(...i)=>s.fetchTests&&s.fetchTests(...i)),class:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition duration-200"},e[9]||(e[9]=[t("i",{class:"fas fa-redo mr-2"},null,-1),u("Poskusi ponovno ")]))])])):(d(),l("div",P,[r.searchTerm?(d(),l("div",V,[t("p",E," Found "+c(s.filteredTests.length)+" test"+c(s.filteredTests.length!==1?"s":"")+' for "'+c(r.searchTerm)+'" ',1)])):f("",!0),(d(!0),l(w,null,_(s.filteredTests,i=>(d(),l("div",{key:i.id,class:"test-card rounded-xl p-6 transition-all duration-300 hover:transform hover:scale-105"},[t("div",B,[t("div",null,[t("h2",F,"Test "+c(i.id),1),t("p",H,c(s.formatDate(i.test_date)),1)]),e[12]||(e[12]=t("div",{class:"status-badge"},[t("i",{class:"fas fa-check-circle text-green-500 mr-2"}),t("span",{class:"text-green-600 font-medium"},"Končano")],-1))]),t("div",M,[t("div",G,[e[14]||(e[14]=t("div",{class:"detail-icon athlete-icon"},[t("i",{class:"fas fa-user text-white"})],-1)),t("div",U,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-600"},"Športnik",-1)),t("p",J,c(i.athlete_full_name),1)])])]),t("div",K,[t("button",{onClick:p=>s.viewTest(i.id),class:"view-btn flex-1 py-3 px-6 rounded-lg font-bold transition duration-300"},e[15]||(e[15]=[t("i",{class:"fas fa-eye mr-2"},null,-1),u("PODROBNOSTI ")]),8,R),t("button",{onClick:p=>s.deleteTest(i.id),class:"delete-btn py-3 px-4 rounded-lg transition duration-300"},e[16]||(e[16]=[t("i",{class:"fas fa-trash"},null,-1)]),8,q)])]))),128)),r.tests.length===0&&!r.loading?(d(),l("div",Q,[e[18]||(e[18]=t("div",{class:"empty-icon mb-6"},[t("i",{class:"fas fa-clipboard-list text-6xl text-white/30"})],-1)),e[19]||(e[19]=t("h3",{class:"text-2xl font-bold text-white mb-4"},"Ni najdenih testov.",-1)),e[20]||(e[20]=t("p",{class:"text-white/80 mb-8"},"Nisi ustvaril še nobenega testa.",-1)),t("button",{onClick:e[3]||(e[3]=(...i)=>s.createTest&&s.createTest(...i)),class:"create-btn px-8 py-3 rounded-xl font-bold transition duration-300"},e[17]||(e[17]=[t("i",{class:"fas fa-plus mr-2"},null,-1),u("Ustvari prvi test ")]))])):f("",!0),r.searchTerm&&s.filteredTests.length===0&&r.tests.length>0?(d(),l("div",W,[e[22]||(e[22]=t("div",{class:"empty-icon mb-6"},[t("i",{class:"fas fa-search text-6xl text-white/30"})],-1)),e[23]||(e[23]=t("h3",{class:"text-2xl font-bold text-white mb-4"},"Ni najdenih rezultatov.",-1)),e[24]||(e[24]=t("p",{class:"text-white/80 mb-8"},"Nobeden test ne ustreza iskalnim pogojem.",-1)),t("button",{onClick:e[4]||(e[4]=(...i)=>s.clearSearch&&s.clearSearch(...i)),class:"clear-btn px-8 py-3 rounded-xl font-bold transition duration-300"},e[21]||(e[21]=[t("i",{class:"fas fa-times mr-2"},null,-1),u("Počisti iskanje ")]))])):f("",!0)]))]),t("button",{onClick:e[5]||(e[5]=(...i)=>s.createTest&&s.createTest(...i)),class:"floating-btn fixed bottom-8 right-8 w-16 h-16 rounded-full shadow-lg transition-all duration-300 hover:scale-110"},e[26]||(e[26]=[t("i",{class:"fas fa-plus text-xl text-white"},null,-1)]))])}const ee=b(N,[["render",X],["__scopeId","data-v-342e5c8a"]]);export{ee as default};
