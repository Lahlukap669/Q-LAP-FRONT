import{a as E}from"./api-DUlGAOJP.js";import{_ as D,c as i,a as t,e as u,b as v,w as h,f as y,t as r,d as g,n as _,T as j,o as n,k as I,l as S,F as p,j as b,m as A,h as L}from"./index-Da2PU-7I.js";import{A as z}from"./AppAlert-CPz9EppH.js";const O={name:"AthleteHeader",props:{userFullName:{type:String,default:"Athlete"}},emits:["logout"],data(){return{showUserMenu:!1,showMobileNav:!1}},methods:{toggleUserMenu(){this.showUserMenu=!this.showUserMenu,this.showMobileNav=!1},toggleMobileNav(){this.showMobileNav=!this.showMobileNav,this.showUserMenu=!1,this.showMobileNav?document.body.style.overflow="hidden":document.body.style.overflow=""},closeMobileNav(){this.showMobileNav=!1,document.body.style.overflow=""},handleLogout(){this.showUserMenu=!1,this.showMobileNav=!1,document.body.style.overflow="",this.$emit("logout")},handleResize(){window.innerWidth>=1024&&this.closeMobileNav()}},mounted(){document.addEventListener("click",s=>{!s.target.closest(".relative")&&!s.target.closest("button")&&(this.showUserMenu=!1)}),window.addEventListener("resize",this.handleResize),document.addEventListener("keydown",s=>{s.key==="Escape"&&(this.closeMobileNav(),this.showUserMenu=!1)})},beforeUnmount(){window.removeEventListener("resize",this.handleResize),document.body.style.overflow=""}},V={class:"header-gradient shadow-lg relative"},T={class:"container mx-auto px-4 py-4 flex justify-between items-center"},U={class:"flex items-center space-x-6"},P={class:"hidden lg:flex items-center space-x-6 text-white"},R={class:"hidden lg:block relative"},F={class:"hidden md:block"},B={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50"},H={key:0,class:"lg:hidden absolute top-full left-0 w-full bg-white shadow-lg z-40"},K={class:"container mx-auto px-4 py-4"},J={class:"space-y-4 mb-6"},Q={class:"border-t border-gray-200 pt-4"},W={class:"flex items-center mb-4 px-4"},X={class:"font-semibold text-gray-800"},q={class:"space-y-2"};function G(s,e,d,c,a,l){const f=y("router-link");return n(),i("header",V,[t("div",T,[e[15]||(e[15]=t("div",null,[t("h1",{class:"text-3xl lg:text-4xl font-bold text-white tracking-wider"},"Q-LAP"),t("p",{class:"text-white/90 text-sm"},"Quick Layered Annual Periodization")],-1)),t("div",U,[t("nav",P,[u(f,{to:"/athlete",class:"flex items-center hover:text-white/80 transition duration-200"},{default:h(()=>e[5]||(e[5]=[t("i",{class:"fas fa-home mr-2"},null,-1),g("Nadzorna plošča ")])),_:1,__:[5]}),u(f,{to:"",class:"flex items-center hover:text-white/80 transition duration-200"},{default:h(()=>e[6]||(e[6]=[t("i",{class:"fas fa-users mr-2"},null,-1),g("Športniki ")])),_:1,__:[6]}),u(f,{to:"",class:"flex items-center hover:text-white/80 transition duration-200"},{default:h(()=>e[7]||(e[7]=[t("i",{class:"fas fa-chart-line mr-2"},null,-1),g("Analitika ")])),_:1,__:[7]}),u(f,{to:"",class:"flex items-center hover:text-white/80 transition duration-200"},{default:h(()=>e[8]||(e[8]=[t("i",{class:"fas fa-flask mr-2"},null,-1),g("Testi ")])),_:1,__:[8]})]),t("div",R,[t("button",{onClick:e[0]||(e[0]=(...x)=>l.toggleUserMenu&&l.toggleUserMenu(...x)),class:"flex items-center text-white hover:text-white/80 transition duration-200"},[e[9]||(e[9]=t("i",{class:"fas fa-user-circle text-xl mr-2"},null,-1)),t("span",F,r(d.userFullName),1),e[10]||(e[10]=t("i",{class:"fas fa-chevron-down ml-2"},null,-1))]),a.showUserMenu?(n(),i("div",B,[u(f,{to:"",class:"block px-4 py-2 text-gray-700 hover:bg-gray-100 transition duration-200"},{default:h(()=>e[11]||(e[11]=[t("i",{class:"fas fa-user mr-2"},null,-1),g("Profil ")])),_:1,__:[11]}),u(f,{to:"",class:"block px-4 py-2 text-gray-700 hover:bg-gray-100 transition duration-200"},{default:h(()=>e[12]||(e[12]=[t("i",{class:"fas fa-cog mr-2"},null,-1),g("Nastavitve ")])),_:1,__:[12]}),e[14]||(e[14]=t("hr",{class:"my-1"},null,-1)),t("button",{onClick:e[1]||(e[1]=(...x)=>l.handleLogout&&l.handleLogout(...x)),class:"block w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 transition duration-200"},e[13]||(e[13]=[t("i",{class:"fas fa-sign-out-alt mr-2"},null,-1),g("Odjava ")]))])):v("",!0)]),t("button",{onClick:e[2]||(e[2]=(...x)=>l.toggleMobileNav&&l.toggleMobileNav(...x)),class:"lg:hidden flex items-center text-white hover:text-white/80 transition duration-200"},[t("i",{class:_(["fas fa-bars text-xl transition-transform duration-300",{"rotate-90":a.showMobileNav}])},null,2)])])]),u(j,{name:"mobile-nav"},{default:h(()=>[a.showMobileNav?(n(),i("div",H,[t("nav",K,[t("div",J,[u(f,{to:"/athlete",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[16]||(e[16]=[t("i",{class:"fas fa-home mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Nadzorna plošča",-1)])),_:1,__:[16]},8,["onClick"]),u(f,{to:"",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[17]||(e[17]=[t("i",{class:"fas fa-users mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Športniki",-1)])),_:1,__:[17]},8,["onClick"]),u(f,{to:"",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[18]||(e[18]=[t("i",{class:"fas fa-chart-line mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Analitika",-1)])),_:1,__:[18]},8,["onClick"]),u(f,{to:"",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[19]||(e[19]=[t("i",{class:"fas fa-flask mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Testi",-1)])),_:1,__:[19]},8,["onClick"])]),t("div",Q,[t("div",W,[e[20]||(e[20]=t("i",{class:"fas fa-user-circle text-2xl text-gray-600 mr-3"},null,-1)),t("span",X,r(d.userFullName),1)]),t("div",q,[u(f,{to:"",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[21]||(e[21]=[t("i",{class:"fas fa-user mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Profil",-1)])),_:1,__:[21]},8,["onClick"]),u(f,{to:"",onClick:l.closeMobileNav,class:"flex items-center text-gray-700 hover:text-blue-600 hover:bg-gray-50 py-3 px-4 rounded-lg transition duration-200"},{default:h(()=>e[22]||(e[22]=[t("i",{class:"fas fa-cog mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Nastavitve",-1)])),_:1,__:[22]},8,["onClick"]),t("button",{onClick:e[3]||(e[3]=(...x)=>l.handleLogout&&l.handleLogout(...x)),class:"flex items-center w-full text-red-600 hover:text-red-700 hover:bg-red-50 py-3 px-4 rounded-lg transition duration-200"},e[23]||(e[23]=[t("i",{class:"fas fa-sign-out-alt mr-4 text-lg"},null,-1),t("span",{class:"text-lg"},"Odjava",-1)]))])])])])):v("",!0)]),_:1}),a.showMobileNav?(n(),i("div",{key:0,onClick:e[4]||(e[4]=(...x)=>l.closeMobileNav&&l.closeMobileNav(...x)),class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30"})):v("",!0)])}const Y=D(O,[["render",G],["__scopeId","data-v-c3bb278a"]]),Z={name:"DashboardView",components:{AthleteHeader:Y,AppAlert:z},data(){return{loading:!0,error:null,dayInfo:null,selectedDate:this.getCurrentDate(),showModal:!1,selectedExercise:{},headerMounted:!1,alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const s=JSON.parse(localStorage.getItem("user")||"{}");return`${s.first_name} ${s.last_name}`||"Atlet"},formattedExerciseDate(){return this.selectedDate?new Date(this.selectedDate).toLocaleDateString("sl-SI",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Ni datuma"},availableDates(){const s=[],e=new Date;for(let d=-7;d<=7;d++){const c=new Date(e);c.setDate(e.getDate()+d);const a=c.toISOString().split("T")[0],l=c.toLocaleDateString("sl-SI",{weekday:"short",month:"short",day:"numeric"});s.push({value:a,label:l})}return s},totalExercisesCount(){var s;return(s=this.dayInfo)!=null&&s.methods?this.dayInfo.methods.reduce((e,d)=>{var c;return e+(((c=d.exercises)==null?void 0:c.length)||0)},0):0},completedExercisesCount(){var s;return(s=this.dayInfo)!=null&&s.methods?this.dayInfo.methods.reduce((e,d)=>{var c;return e+(((c=d.exercises)==null?void 0:c.filter(a=>a.exercise_finished).length)||0)},0):0},progressPercentage(){return this.totalExercisesCount===0?0:this.completedExercisesCount/this.totalExercisesCount*100}},methods:{getCurrentDate(){return new Date().toISOString().split("T")[0]},showAlert(s,e){this.alert={show:!0,type:s,message:e}},async fetchDayExercises(){var s,e,d;this.headerMounted||(this.loading=!0),this.error=null;try{const c=await E.post("/athlete/microcycle-info",{current_date:this.selectedDate});this.dayInfo=c.data,this.headerMounted||(this.headerMounted=!0)}catch(c){console.error("Napaka pri pridobivanju vaj:",c),((s=c.response)==null?void 0:s.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((d=(e=c.response)==null?void 0:e.data)==null?void 0:d.message)||"Napaka pri nalaganju vaj za ta dan."}finally{this.loading=!1}},onDateChange(){this.loading=!0,this.fetchDayExercises()},previousDay(){const s=new Date(this.selectedDate);s.setDate(s.getDate()-1),this.selectedDate=s.toISOString().split("T")[0],this.loading=!0,this.fetchDayExercises()},nextDay(){const s=new Date(this.selectedDate);s.setDate(s.getDate()+1),this.selectedDate=s.toISOString().split("T")[0],this.loading=!0,this.fetchDayExercises()},async toggleExerciseCompletion(s){try{s.exercise_finished=!s.exercise_finished,this.showAlert("success",s.exercise_finished?"Vaja označena kot končana!":"Vaja označena kot nedokončana.")}catch(e){s.exercise_finished=!s.exercise_finished,console.error("Napaka pri posodabljanju stanja vaje:",e),this.showAlert("error","Napaka pri posodabljanju stanja vaje.")}},showExerciseInfo(s){this.selectedExercise=s,this.showModal=!0},closeModal(){this.showModal=!1,this.selectedExercise={}},formatRestTime(s){if(!s)return"/";const e=Math.floor(s/60),d=s%60;return e===0?`${d} s`:d===0?`${e} min`:`${e} min ${d} s`},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchDayExercises(),document.addEventListener("keydown",e=>{e.key==="ArrowLeft"?this.previousDay():e.key==="ArrowRight"?this.nextDay():e.key==="Escape"&&this.closeModal()})},beforeUnmount(){document.removeEventListener("keydown",this.handleKeydown)}},$={class:"min-h-screen athlete-dashboard-bg"},ee={key:0,class:"flex items-center justify-center min-h-screen"},te={key:1,class:"flex items-center justify-center min-h-screen"},se={class:"text-center bg-white rounded-xl p-8 mx-4"},le={class:"text-gray-600 mb-4"},ae={key:2,class:"container mx-auto px-4 py-6"},oe={class:"exercise-date-header rounded-xl p-6 mb-6"},ie={class:"flex items-center justify-between"},ne={class:"flex items-center space-x-6"},re={class:"flex items-center space-x-3"},de={class:"text-2xl font-bold text-white"},ce={class:"flex items-center space-x-3"},ue=["value"],fe={key:0,class:"flex items-center text-white"},he={key:0,class:"rest-day-banner rounded-xl p-6 mb-6"},xe={class:"exercises-table rounded-xl overflow-hidden"},ve={class:"exercise-rows"},me={class:"col-span-1 flex justify-center"},ge=["checked","onChange"],pe={class:"col-span-3 flex items-center space-x-2"},be={class:"difficulty-badge"},ye={class:"col-span-1 text-center parameter-value"},_e={class:"col-span-1 text-center parameter-value"},we={class:"col-span-1 text-center parameter-value"},ke={class:"col-span-1 text-center parameter-value"},Me={class:"col-span-1 text-center parameter-value"},Ne={class:"col-span-1 text-center parameter-value"},De={class:"col-span-1 text-center"},Ce={class:"method-group-badge"},Ee={class:"col-span-1 flex justify-center"},je=["onClick"],Ie={key:0,class:"empty-state"},Se={key:1,class:"progress-summary rounded-xl p-6 mt-6"},Ae={class:"flex items-center justify-between"},Le={class:"text-gray-600"},ze={class:"progress-circle"},Oe={viewBox:"0 0 36 36",class:"circular-chart"},Ve=["stroke-dasharray"],Te={class:"percentage"},Ue={key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Pe={class:"modal-content max-w-2xl w-full max-h-[80vh] overflow-y-auto"},Re={class:"flex justify-between items-start mb-4"},Fe={class:"modal-title"},Be={class:"exercise-details"},He={class:"detail-row"},Ke={class:"detail-value"},Je={key:0,class:"detail-row"},Qe=["href"],We={class:"exercise-description"},Xe={class:"description-text"};function qe(s,e,d,c,a,l){var w,k,M,N;const f=y("AthleteHeader"),x=y("AppAlert");return n(),i("div",$,[u(f,{"user-full-name":l.userFullName,onLogout:l.logout},null,8,["user-full-name","onLogout"]),a.loading&&!a.headerMounted?(n(),i("div",ee,e[7]||(e[7]=[t("div",{class:"text-center"},[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"}),t("p",{class:"text-white text-lg"},"Nalaganje dnevnih vaj...")],-1)]))):a.error&&!a.headerMounted?(n(),i("div",te,[t("div",se,[e[9]||(e[9]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[10]||(e[10]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju vaj",-1)),t("p",le,r(a.error),1),t("button",{onClick:e[0]||(e[0]=(...o)=>l.fetchDayExercises&&l.fetchDayExercises(...o)),class:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition duration-200"},e[8]||(e[8]=[t("i",{class:"fas fa-redo mr-2"},null,-1),g("Poskusi ponovno ")]))])])):(n(),i("div",ae,[t("div",oe,[t("div",ie,[t("div",ne,[t("div",re,[e[11]||(e[11]=t("i",{class:"fas fa-calendar text-2xl text-white"},null,-1)),t("h1",de,r(l.formattedExerciseDate),1)]),t("div",ce,[t("button",{onClick:e[1]||(e[1]=o=>l.previousDay()),class:"nav-button"},e[12]||(e[12]=[t("i",{class:"fas fa-chevron-left"},null,-1)])),I(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.selectedDate=o),onChange:e[3]||(e[3]=(...o)=>l.onDateChange&&l.onDateChange(...o)),class:"day-select-inline"},[(n(!0),i(p,null,b(l.availableDates,o=>(n(),i("option",{key:o.value,value:o.value},r(o.label),9,ue))),128))],544),[[S,a.selectedDate]]),t("button",{onClick:e[4]||(e[4]=o=>l.nextDay()),class:"nav-button"},e[13]||(e[13]=[t("i",{class:"fas fa-chevron-right"},null,-1)]))])]),a.loading&&a.headerMounted?(n(),i("div",fe,e[14]||(e[14]=[t("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),t("span",null,"Nalaganje...",-1)]))):v("",!0)])]),(w=a.dayInfo)!=null&&w.active_rest?(n(),i("div",he,e[15]||(e[15]=[t("div",{class:"flex items-center"},[t("i",{class:"fas fa-bed text-2xl text-blue-600 mr-4"}),t("div",null,[t("h3",{class:"text-xl font-bold text-blue-800"},"Dan počitka"),t("p",{class:"text-blue-700"},"Danes je predviden aktivni počitek. Priporočamo lahke aktivnosti.")])],-1)]))):v("",!0),t("div",xe,[e[18]||(e[18]=A('<div class="table-header grid grid-cols-12 gap-4 p-4" data-v-3b054e4c><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>KONČANO</div><div class="col-span-3 text-center font-semibold text-white" data-v-3b054e4c>VAJA</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>SERIJE</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>PONOVITVE</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>OBREMENITEV %</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>VO2 MAX</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>HR %</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>POČITEK</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>SKUPINA</div><div class="col-span-1 text-center font-semibold text-white" data-v-3b054e4c>OPIS</div></div>',1)),t("div",ve,[(n(!0),i(p,null,b(((k=a.dayInfo)==null?void 0:k.methods)||[],o=>(n(),i(p,{key:o.method_id},[(n(!0),i(p,null,b(o.exercises,m=>(n(),i("div",{key:m.exercise_id,class:_(["exercise-row grid grid-cols-12 gap-4 p-4 items-center hover:bg-white/10 transition duration-200",{"completed-exercise":m.exercise_finished}])},[t("div",me,[t("input",{type:"checkbox",checked:m.exercise_finished,onChange:C=>l.toggleExerciseCompletion(m),class:"exercise-checkbox"},null,40,ge)]),t("div",pe,[t("span",{class:_(["exercise-name",{"completed-text":m.exercise_finished}])},r(m.exercise_name),3),t("div",be,r(m.difficulty)+"/10 ",1)]),t("div",ye,r(o.method_parameters.sets||"/"),1),t("div",_e,r(o.method_parameters.repetitions||"/"),1),t("div",we,r(o.method_parameters.burden_percentage_of_mvc?o.method_parameters.burden_percentage_of_mvc+" %":"/"),1),t("div",ke,r(o.method_parameters.vo2_max?o.method_parameters.vo2_max+" %":"/"),1),t("div",Me,r(o.method_parameters.hr_percentage?o.method_parameters.hr_percentage+" %":"/"),1),t("div",Ne,r(l.formatRestTime(o.method_parameters.rest_seconds)),1),t("div",De,[t("span",Ce,r(o.method_group),1)]),t("div",Ee,[t("button",{onClick:C=>l.showExerciseInfo(m),class:"info-button"},e[16]||(e[16]=[t("i",{class:"fas fa-info-circle"},null,-1)]),8,je)])],2))),128))],64))),128))]),!((M=a.dayInfo)!=null&&M.methods)||a.dayInfo.methods.length===0?(n(),i("div",Ie,e[17]||(e[17]=[t("div",{class:"text-center py-12"},[t("i",{class:"fas fa-dumbbell text-4xl text-white/50 mb-4"}),t("h3",{class:"text-xl font-bold text-white mb-2"},"Ni vaj"),t("p",{class:"text-white/80"},"Na ta dan ni predvidena nobena vaja.")],-1)]))):v("",!0)]),(N=a.dayInfo)!=null&&N.methods&&a.dayInfo.methods.length>0?(n(),i("div",Se,[t("div",Ae,[t("div",null,[e[19]||(e[19]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napredek za danes",-1)),t("p",Le,"Končano "+r(l.completedExercisesCount)+" od "+r(l.totalExercisesCount)+" vaj",1)]),t("div",ze,[t("div",{class:"circle-progress",style:L({"stroke-dasharray":`${l.progressPercentage}, 100`})},[(n(),i("svg",Oe,[e[20]||(e[20]=t("path",{class:"circle-bg",d:`M18 2.0845\r
                  a 15.9155 15.9155 0 0 1 0 31.831\r
                  a 15.9155 15.9155 0 0 1 0 -31.831`},null,-1)),t("path",{class:"circle","stroke-dasharray":`${l.progressPercentage}, 100`,d:`M18 2.0845\r
                  a 15.9155 15.9155 0 0 1 0 31.831\r
                  a 15.9155 15.9155 0 0 1 0 -31.831`},null,8,Ve)])),t("div",Te,r(Math.round(l.progressPercentage))+"%",1)],4)])])])):v("",!0)])),a.showModal?(n(),i("div",Ue,[t("div",Pe,[t("div",Re,[t("h1",Fe,r(a.selectedExercise.exercise_name),1),t("button",{onClick:e[5]||(e[5]=(...o)=>l.closeModal&&l.closeModal(...o)),class:"modal-close"},e[21]||(e[21]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Be,[t("div",He,[e[22]||(e[22]=t("span",{class:"detail-label"},"Težavnost:",-1)),t("span",Ke,r(a.selectedExercise.difficulty)+"/10",1)]),a.selectedExercise.video_url&&a.selectedExercise.video_url!=="/"?(n(),i("div",Je,[e[23]||(e[23]=t("span",{class:"detail-label"},"Video:",-1)),t("a",{href:a.selectedExercise.video_url,target:"_blank",class:"detail-link"},"Oglej si video",8,Qe)])):v("",!0)]),t("div",We,[e[24]||(e[24]=t("h3",{class:"description-title"},"Opis",-1)),t("p",Xe,r(a.selectedExercise.description),1)])])])):v("",!0),u(x,{visible:a.alert.show,type:a.alert.type,message:a.alert.message,onClose:e[6]||(e[6]=o=>a.alert.show=!1)},null,8,["visible","type","message"])])}const $e=D(Z,[["render",qe],["__scopeId","data-v-3b054e4c"]]);export{$e as default};
