import{a as h}from"./api-DUlGAOJP.js";import{T as x}from"./TrainerHeader-Dx3V7vEH.js";import{A as b}from"./AppAlert-CPz9EppH.js";import{_ as k,c as i,e as m,a as t,f,d as c,k as A,v,t as u,b as p,F as _,j as w,o as n}from"./index-Da2PU-7I.js";const j={name:"AddAthleteView",components:{TrainerHeader:x,AppAlert:b},data(){return{athletes:[],loading:!0,error:null,searchQuery:"",addingAthletes:[],alert:{show:!1,type:"info",message:""},searchTimeout:null}},computed:{userFullName(){const s=JSON.parse(localStorage.getItem("user")||"{}");return`${s.first_name} ${s.last_name}`||"Trainer"},filteredAthletes(){if(!this.searchQuery.trim())return this.athletes;const s=this.searchQuery.toLowerCase();return this.athletes.filter(e=>e.first_name.toLowerCase().includes(s)||e.last_name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||`${e.first_name} ${e.last_name}`.toLowerCase().includes(s))}},methods:{showAlert(s,e){this.alert={show:!0,type:s,message:e}},async fetchAthletes(){var s,e,d;this.loading=!0,this.error=null;try{const l=await h.get("/users/trainer/search-athletes");this.athletes=l.data.athletes||[]}catch(l){console.error("Error fetching athletes:",l),((s=l.response)==null?void 0:s.status)===401?this.$router.push("/login"):this.error=((d=(e=l.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to load athletes"}finally{this.loading=!1}},debouncedSearch(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{console.log("Searching for:",this.searchQuery)},300)},async addAthlete(s){var e,d;this.addingAthletes.push(s.id);try{const l=await h.post("/users/trainer/add-athlete",{athlete_id:s.id});this.showAlert("success",l.data.message||`${l.data.athlete_name} successfully added!`),this.athletes=this.athletes.filter(o=>o.id!==s.id),setTimeout(()=>{this.fetchAthletes()},2e3)}catch(l){console.error("Error adding athlete:",l),this.showAlert("error",((d=(e=l.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to add athlete")}finally{this.addingAthletes=this.addingAthletes.filter(l=>l!==s.id)}},clearSearch(){this.searchQuery=""},goToMyAthletes(){this.$router.push("/trainer/my-athletes")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchAthletes()}},T={class:"min-h-screen content-bg"},C={class:"container mx-auto px-4 py-6"},S={class:"welcome-section rounded-xl p-8 mb-8"},N={class:"flex justify-between items-center"},Q={class:"search-card rounded-xl p-6 mb-6"},I={class:"relative"},L={key:0,class:"text-center py-12"},V={key:1,class:"error-card rounded-xl p-8 text-center"},z={class:"text-gray-600 mb-4"},F={key:2,class:"space-y-4"},D={class:"flex items-center space-x-4"},M={class:"text-lg font-bold text-gray-800"},B={class:"text-gray-600"},E=["onClick","disabled"],H={key:0,class:"fas fa-spinner fa-spin mr-2"},P={key:1,class:"fas fa-user-plus mr-2"},q={key:0,class:"empty-state rounded-xl p-12 text-center"},J={class:"text-gray-500 mb-6"};function O(s,e,d,l,o,a){const g=f("TrainerHeader"),y=f("AppAlert");return n(),i("div",T,[m(g,{"user-full-name":a.userFullName,onLogout:a.logout},null,8,["user-full-name","onLogout"]),t("main",C,[t("div",S,[t("div",N,[e[7]||(e[7]=t("div",null,[t("h2",{class:"text-3xl font-bold text-white mb-2"}," Dodaj športnika "),t("p",{class:"text-white/90 text-lg"}," Išči in dodaj športnike za svoje ciklizacije. ")],-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>a.goToMyAthletes&&a.goToMyAthletes(...r)),class:"back-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},e[6]||(e[6]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),c("Nazaj na moje špornike ")]))])]),t("div",Q,[t("div",I,[e[8]||(e[8]=t("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"},null,-1)),A(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=r=>o.searchQuery=r),onInput:e[2]||(e[2]=(...r)=>a.debouncedSearch&&a.debouncedSearch(...r)),placeholder:"Išči športnika po imenu ali e-pošti...",class:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200"},null,544),[[v,o.searchQuery]])])]),o.loading?(n(),i("div",L,e[9]||(e[9]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1),t("p",{class:"text-white text-lg"},"Nalagam športnike",-1)]))):o.error?(n(),i("div",V,[e[11]||(e[11]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[12]||(e[12]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju športnikov",-1)),t("p",z,u(o.error),1),t("button",{onClick:e[3]||(e[3]=(...r)=>a.fetchAthletes&&a.fetchAthletes(...r)),class:"retry-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[10]||(e[10]=[t("i",{class:"fas fa-redo mr-2"},null,-1),c("Poskusi ponovno ")]))])):(n(),i("div",F,[(n(!0),i(_,null,w(a.filteredAthletes,r=>(n(),i("div",{key:r.id,class:"athlete-card rounded-xl p-6 flex justify-between items-center"},[t("div",D,[e[13]||(e[13]=t("div",{class:"athlete-avatar"},[t("i",{class:"fas fa-user-circle text-4xl text-gray-400"})],-1)),t("div",null,[t("h3",M,u(r.first_name)+" "+u(r.last_name),1),t("p",B,u(r.email),1)])]),t("button",{onClick:U=>a.addAthlete(r),disabled:o.addingAthletes.includes(r.id),class:"add-athlete-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},[o.addingAthletes.includes(r.id)?(n(),i("i",H)):(n(),i("i",P)),c(" "+u(o.addingAthletes.includes(r.id)?"Dodajanje...":"Dodaj športnika"),1)],8,E)]))),128)),a.filteredAthletes.length===0&&!o.loading?(n(),i("div",q,[e[15]||(e[15]=t("i",{class:"fas fa-users text-6xl text-gray-400 mb-4"},null,-1)),e[16]||(e[16]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Ni bilo najdenih špornikov.",-1)),t("p",J,u(o.searchQuery?"Poskusi dodati kriterije za iskanje športnika.":"Ni razpoložljivih športnikov za dodajanje."),1),o.searchQuery?(n(),i("button",{key:0,onClick:e[4]||(e[4]=(...r)=>a.clearSearch&&a.clearSearch(...r)),class:"clear-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[14]||(e[14]=[t("i",{class:"fas fa-times mr-2"},null,-1),c("Počisti iskalnik ")]))):p("",!0)])):p("",!0)]))]),m(y,{visible:o.alert.show,type:o.alert.type,message:o.alert.message,onClose:e[5]||(e[5]=r=>o.alert.show=!1)},null,8,["visible","type","message"])])}const X=k(j,[["render",O],["__scopeId","data-v-56ac1fb7"]]);export{X as default};
