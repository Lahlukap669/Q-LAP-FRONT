import{a as I}from"./api-wZ4aHSpU.js";import{T as W}from"./TrainerHeader-DSZRr5hb.js";import{A as b}from"./AppAlert-Dq9MU9kQ.js";import{_ as M,c as i,e as _,f as g,a as e,t as n,d as v,F as k,j as h,m as T,o,n as f}from"./index-DRO6Msb-.js";const A={name:"PeriodizationInfoView",components:{TrainerHeader:W,AppAlert:b},data(){return{loading:!0,error:null,periodizationInfo:null,currentDate:new Date(2025,5,1),alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const t=JSON.parse(localStorage.getItem("user")||"{}");return`${t.first_name} ${t.last_name}`||"Trainer"},allWeeks(){if(!this.periodizationInfo)return[];const t=[];return this.periodizationInfo.mesocycles.forEach((s,m)=>{s.microcycles.forEach(c=>{t.push({mesocycleIndex:m,microcycle:c,isActiveRest:c.active_rest})})}),t},currentWeek(){if(!this.periodizationInfo)return 0;const t=new Date(this.periodizationInfo.start_date),s=Math.floor((this.currentDate-t)/(1e3*60*60*24)),m=Math.floor(s/7);return Math.max(1,Math.min(m+1,this.totalWeeks))},totalWeeks(){return this.periodizationInfo?this.allWeeks.length:0},daysToCompetition(){if(!this.periodizationInfo)return 0;const t=new Date(this.periodizationInfo.end_date),s=Math.floor((t-this.currentDate)/(1e3*60*60*24));return Math.max(0,s)},currentMesocycle(){if(!this.periodizationInfo||this.currentWeek<=0)return 1;const t=this.allWeeks[this.currentWeek-1];return t?t.mesocycleIndex+1:1},currentMesocycleData(){return this.periodizationInfo?this.periodizationInfo.mesocycles[this.currentMesocycle-1]||{}:{}}},methods:{showAlert(t,s){this.alert={show:!0,type:t,message:s}},navigateToMicrocycle(t,s){if(!t.microcycle||!t.microcycle.id){this.showAlert("error","Mikrocikel ID ni na voljo za ta teden.");return}const m=t.microcycle.id;this.$router.push(`/trainer/microcycle/${m}/1`).catch(d=>{console.error("Navigation error:",d),this.showAlert("error","Napaka pri navigaciji na mikrocikel.")})},getWeekTooltip(t,s){return!t.microcycle||!t.microcycle.id?"Mikrocikel ni na voljo":s===this.totalWeeks?`Klikni za ogled mikrocikel ${t.microcycle.id} (Teden tekmovanja)`:t.isActiveRest?`Klikni za ogled mikrocikel ${t.microcycle.id} (Aktivni počitek)`:`Klikni za ogled mikrocikel ${t.microcycle.id}`},async fetchPeriodizationInfo(){var t,s,m;this.loading=!0,this.error=null;try{const c=this.$route.params.id;if(!c){this.error="No periodization ID provided";return}const d=await I.get(`/periodization-info/${c}`);this.periodizationInfo=d.data.periodization_info}catch(c){console.error("Napaka pri nalaganju vsebine ciklizacije:",c),((t=c.response)==null?void 0:t.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((m=(s=c.response)==null?void 0:s.data)==null?void 0:m.message)||"Napaka pri nalaganju vsebine ciklizacije."}finally{this.loading=!1}},getWeekRange(t){if(!this.periodizationInfo)return"1-1";let s=1;for(let c=0;c<t;c++)s+=this.periodizationInfo.mesocycles[c].number_of_microcycles;const m=s+this.periodizationInfo.mesocycles[t].number_of_microcycles-1;return`${s}-${m}`},getWeekBlockClass(t,s){return s===this.totalWeeks?"competition-week":t.isActiveRest?"recovery-week":this.getMesocycleClass(t.mesocycleIndex)},getMesocycleClass(t){return["mesocycle-1","mesocycle-2","mesocycle-3","mesocycle-4","mesocycle-5","mesocycle-6","mesocycle-7","mesocycle-8","mesocycle-9","mesocycle-10","mesocycle-11","mesocycle-12","mesocycle-13","mesocycle-14","mesocycle-15","mesocycle-16","mesocycle-17","mesocycle-18","mesocycle-19","mesocycle-20"][t]||"mesocycle-1"},getCurrentWeekType(){return this.currentWeek<=0||this.currentWeek>this.allWeeks.length?"Neznano":this.allWeeks[this.currentWeek-1].isActiveRest?"Aktivni počitek (2:1 razmerje)":this.currentWeek===this.totalWeeks?"Teden tekme":"Teden treninga"},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchPeriodizationInfo()}},j={class:"periodization-bg"},C={key:0,class:"loading-container container mx-auto px-4 py-4"},N={key:1,class:"error-container container mx-auto px-4 py-4"},D={class:"error-card"},x={class:"error-text"},w={key:2,class:"dashboard-container container mx-auto px-4 py-4"},P={class:"header-section"},S={class:"header-card"},R={class:"stats-grid"},E={class:"stat-card"},K={class:"stat-number"},V={class:"stat-card"},B={class:"stat-number"},L={class:"stat-card"},F={class:"stat-number"},O={class:"timeline-section"},H={class:"timeline-card"},J={class:"week-blocks-container"},Z=["onClick","title"],G={key:0,class:"competition-content"},q={class:"week-number"},Q={key:1},U={class:"legend-container"},X={class:"legend-grid"},Y={class:"legend-text"},$={class:"mesocycles-grid"},ee={class:"mesocycle-header"},se={class:"mesocycle-title"},te={class:"mesocycle-weeks"},ie={class:"mesocycle-section"},oe={class:"abilities-container"},ne={class:"mesocycle-section"},re={class:"methods-list"},ae={class:"mesocycle-section"},le={class:"method-groups-list"},ce={class:"mesocycle-section"},de={class:"exercise-list"},ue={class:"exercise-count"},me={class:"week-details-section"},ke={class:"week-details-card"},he={class:"details-title"},ve={class:"details-grid"},ye={class:"details-column"},fe={class:"training-methods-detail"},_e={class:"method-detail-name"},ge={class:"details-column"},pe={class:"exercise-detail-list"},ze={class:"week-info-section"},Ie={class:"info-grid"},We={class:"info-card"},be={class:"info-card"},Me={class:"info-card"},Te={class:"info-card"};function Ae(t,s,m,c,d,r){const p=g("TrainerHeader"),z=g("AppAlert");return o(),i("div",j,[_(p,{"user-full-name":r.userFullName,onLogout:r.logout},null,8,["user-full-name","onLogout"]),d.loading?(o(),i("div",C,s[2]||(s[2]=[e("div",{class:"loading-content"},[e("i",{class:"fas fa-spinner fa-spin loading-spinner"}),e("p",{class:"loading-text"},"Nalaganje ciklizacije...")],-1)]))):d.error?(o(),i("div",N,[e("div",D,[s[4]||(s[4]=e("i",{class:"fas fa-exclamation-triangle error-icon"},null,-1)),s[5]||(s[5]=e("h3",{class:"error-title"},"Napaka pri nalaganju ciklizacije.",-1)),e("p",x,n(d.error),1),e("button",{onClick:s[0]||(s[0]=(...a)=>r.fetchPeriodizationInfo&&r.fetchPeriodizationInfo(...a)),class:"retry-button"},s[3]||(s[3]=[e("i",{class:"fas fa-redo button-icon"},null,-1),v("Poskusi ponovno ")]))])])):(o(),i("div",w,[e("div",P,[e("div",S,[s[9]||(s[9]=e("h1",{class:"header-title"},[e("i",{class:"fas fa-calendar header-icon"}),v("NAČRT CIKLIZACIJE ")],-1)),e("div",R,[e("div",E,[e("div",K,n(r.currentWeek),1),s[6]||(s[6]=e("div",{class:"stat-label"},"Trenutni teden",-1))]),e("div",V,[e("div",B,n(r.totalWeeks),1),s[7]||(s[7]=e("div",{class:"stat-label"},"Skupno tedni",-1))]),e("div",L,[e("div",F,n(r.daysToCompetition),1),s[8]||(s[8]=e("div",{class:"stat-label"},"Dnevi do glavnega tekmovanja",-1))])])])]),e("div",O,[e("div",H,[s[12]||(s[12]=e("h3",{class:"section-title"},"Časovni potek ciklizacije",-1)),e("div",J,[(o(!0),i(k,null,h(r.allWeeks,(a,l)=>{var u;return o(),i("div",{key:l,class:f(["week-block",r.getWeekBlockClass(a,l+1)]),onClick:y=>r.navigateToMicrocycle(a,l+1),title:`Klikni za ogled mikrocikel ${((u=a.microcycle)==null?void 0:u.id)||"N/A"}`},[l+1===r.totalWeeks?(o(),i("div",G,[e("span",q,n(l+1),1),s[10]||(s[10]=e("i",{class:"fas fa-crown competition-crown"},null,-1))])):(o(),i("span",Q,n(l+1),1))],10,Z)}),128))]),e("div",U,[e("div",X,[(o(!0),i(k,null,h(d.periodizationInfo.mesocycles,(a,l)=>(o(),i("div",{key:l,class:"legend-item"},[e("div",{class:f(["legend-color",r.getMesocycleClass(l)])},null,2),e("span",Y,"Mezocikel "+n(l+1),1)]))),128)),s[11]||(s[11]=T('<div class="legend-item" data-v-dd2279aa><div class="legend-color recovery-color" data-v-dd2279aa></div><span class="legend-text" data-v-dd2279aa>Aktivni počitek</span></div><div class="legend-item" data-v-dd2279aa><div class="legend-color competition-legend" data-v-dd2279aa></div><span class="legend-text" data-v-dd2279aa>Tekmovanje</span></div>',2))])])])]),e("div",$,[(o(!0),i(k,null,h(d.periodizationInfo.mesocycles,(a,l)=>(o(),i("div",{key:l,class:"mesocycle-card"},[e("div",ee,[e("div",{class:f(["mesocycle-indicator",r.getMesocycleClass(l)])},null,2),e("div",null,[e("h4",se,"MEZOCIKEL "+n(l+1),1),e("p",te,"Weeks "+n(r.getWeekRange(l)),1)])]),e("div",ie,[s[13]||(s[13]=e("h6",{class:"section-subtitle"},"Gibalne sposobnosti:",-1)),e("div",oe,[(o(!0),i(k,null,h(a.motor_abilities,u=>(o(),i("span",{key:u,class:"ability-badge"},n(u),1))),128))])]),e("div",ne,[s[14]||(s[14]=e("h6",{class:"section-subtitle"},"Metode treninga:",-1)),e("div",re,[(o(!0),i(k,null,h(a.training_methods,(u,y)=>(o(),i("div",{key:y,class:"method-item"},n(u),1))),128))])]),e("div",ae,[s[15]||(s[15]=e("h6",{class:"section-subtitle"},"Podkategorije gibalnih sposobnosti:",-1)),e("div",le,[(o(!0),i(k,null,h(a.method_groups,(u,y)=>(o(),i("span",{key:y,class:"method-group-badge"},n(u),1))),128))])]),e("div",ce,[s[16]||(s[16]=e("h6",{class:"section-subtitle"},"Nekatere vaje:",-1)),e("ul",de,[(o(!0),i(k,null,h(a.key_exercises,u=>(o(),i("li",{key:u.exercise_id,class:"exercise-item"},[v(n(u.exercise_name)+" ",1),e("span",ue,"("+n(u.usage_count)+"x)",1)]))),128))])])]))),128))]),e("div",me,[e("div",ke,[e("h3",he," Teden "+n(r.currentWeek)+" - (Mezocikel "+n(r.currentMesocycle)+") ",1),e("div",ve,[e("div",ye,[s[17]||(s[17]=e("h5",{class:"details-subtitle"},"Metode treninga",-1)),e("div",fe,[(o(!0),i(k,null,h(r.currentMesocycleData.training_methods,(a,l)=>(o(),i("div",{key:l,class:"method-detail-card"},[e("span",_e,n(a),1)]))),128))])]),e("div",ge,[s[18]||(s[18]=e("h5",{class:"details-subtitle"},"Nekatere vaje",-1)),e("ul",pe,[(o(!0),i(k,null,h(r.currentMesocycleData.key_exercises,a=>(o(),i("li",{key:a.exercise_id,class:"exercise-detail-item"},n(a.exercise_name),1))),128))])])]),e("div",ze,[e("div",Ie,[e("div",We,[s[19]||(s[19]=e("strong",null,"Mezocikel:",-1)),v(" "+n(r.currentMesocycle),1)]),e("div",be,[s[20]||(s[20]=e("strong",null,"Težavnost:",-1)),v(" "+n(d.periodizationInfo.difficulty)+"/10 ",1)]),e("div",Me,[s[21]||(s[21]=e("strong",null,"Atlet:",-1)),v(" "+n(d.periodizationInfo.name),1)]),e("div",Te,[s[22]||(s[22]=e("strong",null,"Tip:",-1)),v(" "+n(r.getCurrentWeekType()),1)])])])])])])),_(z,{visible:d.alert.show,type:d.alert.type,message:d.alert.message,onClose:s[1]||(s[1]=a=>d.alert.show=!1)},null,8,["visible","type","message"])])}const xe=M(A,[["render",Ae],["__scopeId","data-v-dd2279aa"]]);export{xe as default};
