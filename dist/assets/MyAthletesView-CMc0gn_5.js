import{a as p}from"./api-wZ4aHSpU.js";import{T as x}from"./TrainerHeader-DSZRr5hb.js";import{A as y}from"./AppAlert-Dq9MU9kQ.js";import{_ as b,c as i,e as c,a as t,f,d as m,t as u,b as A,F as k,j as _,o as a}from"./index-DRO6Msb-.js";const v={name:"MyAthletesView",components:{TrainerHeader:x,AppAlert:y},data(){return{athletes:[],loading:!0,error:null,deletingAthletes:[],alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const r=JSON.parse(localStorage.getItem("user")||"{}");return`${r.first_name} ${r.last_name}`||"Trainer"}},methods:{showAlert(r,e){this.alert={show:!0,type:r,message:e}},async fetchAthletes(){var r,e,d;this.loading=!0,this.error=null;try{const l=await p.get("/users/trainer/my-athletes");this.athletes=l.data.athletes||[]}catch(l){console.error("Error fetching athletes:",l),((r=l.response)==null?void 0:r.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((d=(e=l.response)==null?void 0:e.data)==null?void 0:d.message)||"Napaka pri nalaganju športnikov."}finally{this.loading=!1}},async deleteAthlete(r){var e,d,l;if(confirm(`Si prepričan, da želiš izbrisati ${r.first_name} ${r.last_name}?`)){this.deletingAthletes.push(r.id);try{await p.delete(`/users/trainer/delete-athlete/${r.id}`),this.showAlert("success",`${r.first_name} ${r.last_name} je bil izbrisan.`),this.athletes=this.athletes.filter(s=>s.id!==r.id)}catch(s){console.error("Error deleting athlete:",s),((e=s.response)==null?void 0:e.status)===401?this.$router.push("/login"):this.showAlert("error",((l=(d=s.response)==null?void 0:d.data)==null?void 0:l.message)||"Napaka pri brisanju športnika.")}finally{this.deletingAthletes=this.deletingAthletes.filter(s=>s!==r.id)}}},goToAddAthlete(){this.$router.push("/trainer/add-athlete")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchAthletes()}},w={class:"min-h-screen content-bg"},j={class:"container mx-auto px-4 py-6"},N={class:"welcome-section rounded-xl p-8 mb-8"},T={class:"flex justify-between items-center"},S={key:0,class:"text-center py-12"},C={key:1,class:"error-card rounded-xl p-8 text-center"},I={class:"text-gray-600 mb-4"},V={key:2,class:"space-y-4"},B={class:"flex items-center space-x-4"},F={class:"text-lg font-bold text-gray-800"},D={class:"text-gray-600"},E={class:"text-gray-600"},H=["onClick","disabled"],L={key:0,class:"fas fa-spinner fa-spin mr-2"},M={key:1,class:"fas fa-user-minus mr-2"},z={key:0,class:"empty-state rounded-xl p-12 text-center"};function O(r,e,d,l,s,n){const g=f("TrainerHeader"),h=f("AppAlert");return a(),i("div",w,[c(g,{"user-full-name":n.userFullName,onLogout:n.logout},null,8,["user-full-name","onLogout"]),t("main",j,[t("div",N,[t("div",T,[e[5]||(e[5]=t("div",null,[t("h2",{class:"text-3xl font-bold text-white mb-2"}," My Athlete "),t("p",{class:"text-white/90 text-lg"}," See your athletes. ")],-1)),t("button",{onClick:e[0]||(e[0]=(...o)=>n.goToAddAthlete&&n.goToAddAthlete(...o)),class:"forward-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},e[4]||(e[4]=[t("i",{class:"fas fa-arrow-right mr-2"},null,-1),m("Dodaj športnika ")]))])]),s.loading?(a(),i("div",S,e[6]||(e[6]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1),t("p",{class:"text-white text-lg"},"Nalaganje športnikov...",-1)]))):s.error?(a(),i("div",C,[e[8]||(e[8]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[9]||(e[9]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju športnikov.",-1)),t("p",I,u(s.error),1),t("button",{onClick:e[1]||(e[1]=(...o)=>n.fetchAthletes&&n.fetchAthletes(...o)),class:"retry-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[7]||(e[7]=[t("i",{class:"fas fa-redo mr-2"},null,-1),m("Poskusi ponovno ")]))])):(a(),i("div",V,[(a(!0),i(k,null,_(s.athletes,o=>(a(),i("div",{key:o.id,class:"athlete-card rounded-xl p-6 flex justify-between items-center"},[t("div",B,[e[10]||(e[10]=t("div",{class:"athlete-avatar"},[t("i",{class:"fas fa-user-circle text-4xl text-gray-400"})],-1)),t("div",null,[t("h3",F,u(o.first_name)+" "+u(o.last_name),1),t("p",D,u(o.email),1),t("p",E,u(o.phone_number),1)])]),t("button",{onClick:J=>n.deleteAthlete(o),disabled:s.deletingAthletes.includes(o.id),class:"delete-athlete-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},[s.deletingAthletes.includes(o.id)?(a(),i("i",L)):(a(),i("i",M)),m(" "+u(s.deletingAthletes.includes(o.id)?"Brisanje...":"Odstrani"),1)],8,H)]))),128)),s.athletes.length===0&&!s.loading?(a(),i("div",z,[e[12]||(e[12]=t("i",{class:"fas fa-users text-6xl text-gray-400 mb-4"},null,-1)),e[13]||(e[13]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Športniki niso bili najdeni.",-1)),e[14]||(e[14]=t("p",{class:"text-gray-500 mb-6"},"Nimaš še dodanih športnikov.",-1)),t("button",{onClick:e[2]||(e[2]=(...o)=>n.goToAddAthlete&&n.goToAddAthlete(...o)),class:"create-button px-6 py-3 rounded-lg font-semibold transition duration-200 inline-flex items-center"},e[11]||(e[11]=[t("i",{class:"fas fa-plus mr-2 text-sm"},null,-1),m("Dodaj špornika ")]))])):A("",!0)]))]),c(h,{visible:s.alert.show,type:s.alert.type,message:s.alert.message,onClose:e[3]||(e[3]=o=>s.alert.show=!1)},null,8,["visible","type","message"])])}const Q=b(v,[["render",O],["__scopeId","data-v-198f2571"]]);export{Q as default};
