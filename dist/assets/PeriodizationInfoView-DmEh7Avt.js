import{a as I,A as W}from"./api-BJgnF3hB.js";import{T as b}from"./TrainerHeader-DWaHe2Wg.js";import{A as M}from"./AppAlert-jdCgL8S3.js";import{_ as A,c as o,e as g,f as p,a as e,t as r,d as f,F as k,j as h,m as T,o as i,n as y}from"./index-CZfNrfaq.js";const N={name:"PeriodizationInfoView",components:{TrainerHeader:b,AppAlert:M},data(){return{loading:!0,error:null,periodizationInfo:null,currentDate:new Date(2025,5,1),alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const t=JSON.parse(localStorage.getItem("user")||"{}");return`${t.first_name} ${t.last_name}`||"Trainer"},allWeeks(){if(!this.periodizationInfo)return[];const t=[];return this.periodizationInfo.mesocycles.forEach((s,m)=>{s.microcycles.forEach(d=>{t.push({mesocycleIndex:m,microcycle:d,isActiveRest:d.active_rest})})}),t},currentWeek(){if(!this.periodizationInfo)return 0;const t=new Date(this.periodizationInfo.start_date),s=Math.floor((this.currentDate-t)/(1e3*60*60*24)),m=Math.floor(s/7);return Math.max(1,Math.min(m+1,this.totalWeeks))},totalWeeks(){return this.periodizationInfo?this.allWeeks.length:0},daysToCompetition(){if(!this.periodizationInfo)return 0;const t=new Date(this.periodizationInfo.end_date),s=Math.floor((t-this.currentDate)/(1e3*60*60*24));return Math.max(0,s)},currentMesocycle(){if(!this.periodizationInfo||this.currentWeek<=0)return 1;const t=this.allWeeks[this.currentWeek-1];return t?t.mesocycleIndex+1:1},currentMesocycleData(){return this.periodizationInfo?this.periodizationInfo.mesocycles[this.currentMesocycle-1]||{}:{}}},methods:{showAlert(t,s){this.alert={show:!0,type:t,message:s}},navigateToMicrocycle(t,s){if(!t.microcycle||!t.microcycle.id){this.showAlert("error","Mikrocikel ID ni na voljo za ta teden.");return}const m=t.microcycle.id;this.$router.push(`/trainer/microcycle/${m}/1`).catch(c=>{console.error("Navigation error:",c),this.showAlert("error","Napaka pri navigaciji na mikrocikel.")})},getWeekTooltip(t,s){return!t.microcycle||!t.microcycle.id?"Mikrocikel ni na voljo":s===this.totalWeeks?`Klikni za ogled mikrocikel ${t.microcycle.id} (Teden tekmovanja)`:t.isActiveRest?`Klikni za ogled mikrocikel ${t.microcycle.id} (Aktivni počitek)`:`Klikni za ogled mikrocikel ${t.microcycle.id}`},async fetchPeriodizationInfo(){var t,s,m;this.loading=!0,this.error=null;try{const d=localStorage.getItem("access_token");if(!d){this.$router.push("/login");return}const c=this.$route.params.id;if(!c){this.error="No periodization ID provided";return}const n=await I.get(`${W.LOGIN.replace("/auth/login","")}/periodization-info/${c}`,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});this.periodizationInfo=n.data.periodization_info}catch(d){console.error("Napaka pri nalaganju vsebine ciklizacije:",d),((t=d.response)==null?void 0:t.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((m=(s=d.response)==null?void 0:s.data)==null?void 0:m.message)||"Napaka pri nalaganju vsebine ciklizacije."}finally{this.loading=!1}},getWeekRange(t){if(!this.periodizationInfo)return"1-1";let s=1;for(let d=0;d<t;d++)s+=this.periodizationInfo.mesocycles[d].number_of_microcycles;const m=s+this.periodizationInfo.mesocycles[t].number_of_microcycles-1;return`${s}-${m}`},getWeekBlockClass(t,s){return s===this.totalWeeks?"competition-week":t.isActiveRest?"recovery-week":this.getMesocycleClass(t.mesocycleIndex)},getMesocycleClass(t){return["mesocycle-1","mesocycle-2","mesocycle-3","mesocycle-4","mesocycle-5","mesocycle-6","mesocycle-7","mesocycle-8","mesocycle-9","mesocycle-10","mesocycle-11","mesocycle-12","mesocycle-13","mesocycle-14","mesocycle-15","mesocycle-16","mesocycle-17","mesocycle-18","mesocycle-19","mesocycle-20"][t]||"mesocycle-1"},getCurrentWeekType(){return this.currentWeek<=0||this.currentWeek>this.allWeeks.length?"Neznano":this.allWeeks[this.currentWeek-1].isActiveRest?"Aktivni počitek (2:1 razmerje)":this.currentWeek===this.totalWeeks?"Teden tekme":"Teden treninga"},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchPeriodizationInfo()}},j={class:"periodization-bg"},C={key:0,class:"loading-container container mx-auto px-4 py-4"},D={key:1,class:"error-container container mx-auto px-4 py-4"},x={class:"error-card"},w={class:"error-text"},P={key:2,class:"dashboard-container container mx-auto px-4 py-4"},S={class:"header-section"},E={class:"header-card"},R={class:"stats-grid"},B={class:"stat-card"},K={class:"stat-number"},L={class:"stat-card"},O={class:"stat-number"},V={class:"stat-card"},F={class:"stat-number"},H={class:"timeline-section"},G={class:"timeline-card"},J={class:"week-blocks-container"},Z=["onClick","title"],q={key:0,class:"competition-content"},Q={class:"week-number"},U={key:1},X={class:"legend-container"},Y={class:"legend-grid"},$={class:"legend-text"},ee={class:"mesocycles-grid"},se={class:"mesocycle-header"},te={class:"mesocycle-title"},oe={class:"mesocycle-weeks"},ie={class:"mesocycle-section"},ne={class:"abilities-container"},re={class:"mesocycle-section"},ae={class:"methods-list"},le={class:"mesocycle-section"},ce={class:"method-groups-list"},de={class:"mesocycle-section"},ue={class:"exercise-list"},me={class:"exercise-count"},ke={class:"week-details-section"},he={class:"week-details-card"},fe={class:"details-title"},ve={class:"details-grid"},ye={class:"details-column"},ge={class:"training-methods-detail"},pe={class:"method-detail-name"},_e={class:"details-column"},ze={class:"exercise-detail-list"},Ie={class:"week-info-section"},We={class:"info-grid"},be={class:"info-card"},Me={class:"info-card"},Ae={class:"info-card"},Te={class:"info-card"};function Ne(t,s,m,d,c,n){const _=p("TrainerHeader"),z=p("AppAlert");return i(),o("div",j,[g(_,{"user-full-name":n.userFullName,onLogout:n.logout},null,8,["user-full-name","onLogout"]),c.loading?(i(),o("div",C,s[2]||(s[2]=[e("div",{class:"loading-content"},[e("i",{class:"fas fa-spinner fa-spin loading-spinner"}),e("p",{class:"loading-text"},"Nalaganje ciklizacije...")],-1)]))):c.error?(i(),o("div",D,[e("div",x,[s[4]||(s[4]=e("i",{class:"fas fa-exclamation-triangle error-icon"},null,-1)),s[5]||(s[5]=e("h3",{class:"error-title"},"Napaka pri nalaganju ciklizacije.",-1)),e("p",w,r(c.error),1),e("button",{onClick:s[0]||(s[0]=(...a)=>n.fetchPeriodizationInfo&&n.fetchPeriodizationInfo(...a)),class:"retry-button"},s[3]||(s[3]=[e("i",{class:"fas fa-redo button-icon"},null,-1),f("Poskusi ponovno ")]))])])):(i(),o("div",P,[e("div",S,[e("div",E,[s[9]||(s[9]=e("h1",{class:"header-title"},[e("i",{class:"fas fa-calendar header-icon"}),f("NAČRT CIKLIZACIJE ")],-1)),e("div",R,[e("div",B,[e("div",K,r(n.currentWeek),1),s[6]||(s[6]=e("div",{class:"stat-label"},"Trenutni teden",-1))]),e("div",L,[e("div",O,r(n.totalWeeks),1),s[7]||(s[7]=e("div",{class:"stat-label"},"Skupno tedni",-1))]),e("div",V,[e("div",F,r(n.daysToCompetition),1),s[8]||(s[8]=e("div",{class:"stat-label"},"Dnevi do glavnega tekmovanja",-1))])])])]),e("div",H,[e("div",G,[s[12]||(s[12]=e("h3",{class:"section-title"},"Časovni potek ciklizacije",-1)),e("div",J,[(i(!0),o(k,null,h(n.allWeeks,(a,l)=>{var u;return i(),o("div",{key:l,class:y(["week-block",n.getWeekBlockClass(a,l+1)]),onClick:v=>n.navigateToMicrocycle(a,l+1),title:`Klikni za ogled mikrocikel ${((u=a.microcycle)==null?void 0:u.id)||"N/A"}`},[l+1===n.totalWeeks?(i(),o("div",q,[e("span",Q,r(l+1),1),s[10]||(s[10]=e("i",{class:"fas fa-crown competition-crown"},null,-1))])):(i(),o("span",U,r(l+1),1))],10,Z)}),128))]),e("div",X,[e("div",Y,[(i(!0),o(k,null,h(c.periodizationInfo.mesocycles,(a,l)=>(i(),o("div",{key:l,class:"legend-item"},[e("div",{class:y(["legend-color",n.getMesocycleClass(l)])},null,2),e("span",$,"Mezocikel "+r(l+1),1)]))),128)),s[11]||(s[11]=T('<div class="legend-item" data-v-4eca46cf><div class="legend-color recovery-color" data-v-4eca46cf></div><span class="legend-text" data-v-4eca46cf>Aktivni počitek</span></div><div class="legend-item" data-v-4eca46cf><div class="legend-color competition-legend" data-v-4eca46cf></div><span class="legend-text" data-v-4eca46cf>Tekmovanje</span></div>',2))])])])]),e("div",ee,[(i(!0),o(k,null,h(c.periodizationInfo.mesocycles,(a,l)=>(i(),o("div",{key:l,class:"mesocycle-card"},[e("div",se,[e("div",{class:y(["mesocycle-indicator",n.getMesocycleClass(l)])},null,2),e("div",null,[e("h4",te,"MEZOCIKEL "+r(l+1),1),e("p",oe,"Weeks "+r(n.getWeekRange(l)),1)])]),e("div",ie,[s[13]||(s[13]=e("h6",{class:"section-subtitle"},"Gibalne sposobnosti:",-1)),e("div",ne,[(i(!0),o(k,null,h(a.motor_abilities,u=>(i(),o("span",{key:u,class:"ability-badge"},r(u),1))),128))])]),e("div",re,[s[14]||(s[14]=e("h6",{class:"section-subtitle"},"Metode treninga:",-1)),e("div",ae,[(i(!0),o(k,null,h(a.training_methods,(u,v)=>(i(),o("div",{key:v,class:"method-item"},r(u),1))),128))])]),e("div",le,[s[15]||(s[15]=e("h6",{class:"section-subtitle"},"Podkategorije gibalnih sposobnosti:",-1)),e("div",ce,[(i(!0),o(k,null,h(a.method_groups,(u,v)=>(i(),o("span",{key:v,class:"method-group-badge"},r(u),1))),128))])]),e("div",de,[s[16]||(s[16]=e("h6",{class:"section-subtitle"},"Nekatere vaje:",-1)),e("ul",ue,[(i(!0),o(k,null,h(a.key_exercises,u=>(i(),o("li",{key:u.exercise_id,class:"exercise-item"},[f(r(u.exercise_name)+" ",1),e("span",me,"("+r(u.usage_count)+"x)",1)]))),128))])])]))),128))]),e("div",ke,[e("div",he,[e("h3",fe," Teden "+r(n.currentWeek)+" - (Mezocikel "+r(n.currentMesocycle)+") ",1),e("div",ve,[e("div",ye,[s[17]||(s[17]=e("h5",{class:"details-subtitle"},"Metode treninga",-1)),e("div",ge,[(i(!0),o(k,null,h(n.currentMesocycleData.training_methods,(a,l)=>(i(),o("div",{key:l,class:"method-detail-card"},[e("span",pe,r(a),1)]))),128))])]),e("div",_e,[s[18]||(s[18]=e("h5",{class:"details-subtitle"},"Nekatere vaje",-1)),e("ul",ze,[(i(!0),o(k,null,h(n.currentMesocycleData.key_exercises,a=>(i(),o("li",{key:a.exercise_id,class:"exercise-detail-item"},r(a.exercise_name),1))),128))])])]),e("div",Ie,[e("div",We,[e("div",be,[s[19]||(s[19]=e("strong",null,"Mezocikel:",-1)),f(" "+r(n.currentMesocycle),1)]),e("div",Me,[s[20]||(s[20]=e("strong",null,"Težavnost:",-1)),f(" "+r(c.periodizationInfo.difficulty)+"/10 ",1)]),e("div",Ae,[s[21]||(s[21]=e("strong",null,"Atlet:",-1)),f(" "+r(c.periodizationInfo.name),1)]),e("div",Te,[s[22]||(s[22]=e("strong",null,"Tip:",-1)),f(" "+r(n.getCurrentWeekType()),1)])])])])])])),g(z,{visible:c.alert.show,type:c.alert.type,message:c.alert.message,onClose:s[1]||(s[1]=a=>c.alert.show=!1)},null,8,["visible","type","message"])])}const we=A(N,[["render",Ne],["__scopeId","data-v-4eca46cf"]]);export{we as default};
