import{a as c,A as p}from"./api-BJgnF3hB.js";import{T as y}from"./TrainerHeader-DWaHe2Wg.js";import{A}from"./AppAlert-jdCgL8S3.js";import{_ as b,c as i,e as g,a as t,f,d as m,t as u,b as k,F as _,j as v,o as a}from"./index-CZfNrfaq.js";const w={name:"MyAthletesView",components:{TrainerHeader:y,AppAlert:A},data(){return{athletes:[],loading:!0,error:null,deletingAthletes:[],alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const s=JSON.parse(localStorage.getItem("user")||"{}");return`${s.first_name} ${s.last_name}`||"Trainer"}},methods:{showAlert(s,e){this.alert={show:!0,type:s,message:e}},async fetchAthletes(){var s,e,d;this.loading=!0,this.error=null;try{const n=localStorage.getItem("access_token");if(!n){this.$router.push("/login");return}const r=await c.get(`${p.LOGIN.replace("/auth/login","")}/users/trainer/my-athletes`,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});this.athletes=r.data.athletes||[]}catch(n){console.error("Error fetching athletes:",n),((s=n.response)==null?void 0:s.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Napaka pri nalaganju športnikov."}finally{this.loading=!1}},async deleteAthlete(s){var e,d;if(confirm(`Si prepričan, da želiš izbrisati ${s.first_name} ${s.last_name}?`)){this.deletingAthletes.push(s.id);try{const n=localStorage.getItem("access_token");await c.delete(`${p.LOGIN.replace("/auth/login","")}/users/trainer/delete-athlete/${s.id}`,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}}),this.showAlert("success",`${s.first_name} ${s.last_name} Je bil izbrisan.`),this.athletes=this.athletes.filter(r=>r.id!==s.id)}catch(n){console.error("Error deleting athlete:",n),this.showAlert("error",((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Napaka pri brisanju športnika.")}finally{this.deletingAthletes=this.deletingAthletes.filter(n=>n!==s.id)}}},goToAddAthlete(){this.$router.push("/trainer/add-athlete")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchAthletes()}},N={class:"min-h-screen content-bg"},T={class:"container mx-auto px-4 py-6"},j={class:"welcome-section rounded-xl p-8 mb-8"},I={class:"flex justify-between items-center"},S={key:0,class:"text-center py-12"},C={key:1,class:"error-card rounded-xl p-8 text-center"},B={class:"text-gray-600 mb-4"},V={key:2,class:"space-y-4"},L={class:"flex items-center space-x-4"},O={class:"text-lg font-bold text-gray-800"},z={class:"text-gray-600"},D={class:"text-gray-600"},E=["onClick","disabled"],F={key:0,class:"fas fa-spinner fa-spin mr-2"},H={key:1,class:"fas fa-user-minus mr-2"},M={key:0,class:"empty-state rounded-xl p-12 text-center"};function P(s,e,d,n,r,l){const h=f("TrainerHeader"),x=f("AppAlert");return a(),i("div",N,[g(h,{"user-full-name":l.userFullName,onLogout:l.logout},null,8,["user-full-name","onLogout"]),t("main",T,[t("div",j,[t("div",I,[e[5]||(e[5]=t("div",null,[t("h2",{class:"text-3xl font-bold text-white mb-2"}," My Athlete "),t("p",{class:"text-white/90 text-lg"}," See your athletes. ")],-1)),t("button",{onClick:e[0]||(e[0]=(...o)=>l.goToAddAthlete&&l.goToAddAthlete(...o)),class:"forward-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},e[4]||(e[4]=[t("i",{class:"fas fa-arrow-right mr-2"},null,-1),m("Dodaj športnika ")]))])]),r.loading?(a(),i("div",S,e[6]||(e[6]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1),t("p",{class:"text-white text-lg"},"Nalaganje športnikov...",-1)]))):r.error?(a(),i("div",C,[e[8]||(e[8]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[9]||(e[9]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju športnikov.",-1)),t("p",B,u(r.error),1),t("button",{onClick:e[1]||(e[1]=(...o)=>l.fetchAthletes&&l.fetchAthletes(...o)),class:"retry-button px-6 py-3 rounded-lg font-semibold transition duration-200"},e[7]||(e[7]=[t("i",{class:"fas fa-redo mr-2"},null,-1),m("Poskusi ponovno ")]))])):(a(),i("div",V,[(a(!0),i(_,null,v(r.athletes,o=>(a(),i("div",{key:o.id,class:"athlete-card rounded-xl p-6 flex justify-between items-center"},[t("div",L,[e[10]||(e[10]=t("div",{class:"athlete-avatar"},[t("i",{class:"fas fa-user-circle text-4xl text-gray-400"})],-1)),t("div",null,[t("h3",O,u(o.first_name)+" "+u(o.last_name),1),t("p",z,u(o.email),1),t("p",D,u(o.phone_number),1)])]),t("button",{onClick:G=>l.deleteAthlete(o),disabled:r.deletingAthletes.includes(o.id),class:"delete-athlete-button px-6 py-3 rounded-lg font-semibold transition duration-200 flex items-center"},[r.deletingAthletes.includes(o.id)?(a(),i("i",F)):(a(),i("i",H)),m(" "+u(r.deletingAthletes.includes(o.id)?"Brisanje...":"Odstrani"),1)],8,E)]))),128)),r.athletes.length===0&&!r.loading?(a(),i("div",M,[e[12]||(e[12]=t("i",{class:"fas fa-users text-6xl text-gray-400 mb-4"},null,-1)),e[13]||(e[13]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Športniki niso bili najdeni.",-1)),e[14]||(e[14]=t("p",{class:"text-gray-500 mb-6"},"Nimaš še dodanih športnikov.",-1)),t("button",{onClick:e[2]||(e[2]=(...o)=>l.goToAddAthlete&&l.goToAddAthlete(...o)),class:"create-button px-6 py-3 rounded-lg font-semibold transition duration-200 inline-flex items-center"},e[11]||(e[11]=[t("i",{class:"fas fa-plus mr-2 text-sm"},null,-1),m("Dodaj špornika ")]))])):k("",!0)]))]),g(x,{visible:r.alert.show,type:r.alert.type,message:r.alert.message,onClose:e[3]||(e[3]=o=>r.alert.show=!1)},null,8,["visible","type","message"])])}const R=b(w,[["render",P],["__scopeId","data-v-9e8d4d77"]]);export{R as default};
