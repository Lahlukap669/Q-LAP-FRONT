import{A as I,a as w}from"./api-DUlGAOJP.js";import{T as D}from"./TrainerHeader-Dx3V7vEH.js";import{_ as u,c as d,a as t,o as l,t as m,e as p,w as x,f as c,d as h,g as j,h as E,i as f,b as A,F as S,j as T}from"./index-Da2PU-7I.js";import{B as z}from"./BaseButton-IRkJBuG_.js";import{A as N}from"./AppAlert-CPz9EppH.js";const P={name:"WelcomeSection"},C={class:"welcome-section rounded-xl p-8 mb-8"};function B(o,e,n,r,i,s){return l(),d("div",C,e[0]||(e[0]=[t("h2",{class:"text-3xl font-bold text-white mb-2"}," Trener, dobrodošel nazaj! ",-1),t("p",{class:"text-white/90 text-lg"}," Upravljaj s svojimi ciklizacijami in spremljaj napredek špotnikov. ",-1)]))}const O=u(P,[["render",B],["__scopeId","data-v-515bed3f"]]),L={name:"LoadingSpinner",props:{message:{type:String,default:"Nalaganje..."}}},R={class:"text-center py-12"},F={class:"text-white text-lg"};function M(o,e,n,r,i,s){return l(),d("div",R,[e[0]||(e[0]=t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1)),t("p",F,m(n.message),1)])}const V=u(L,[["render",M]]),Z={name:"ErrorMessage",components:{BaseButton:z},props:{message:{type:String,required:!0}},emits:["retry"]},H={class:"error-card rounded-xl p-8 text-center"},U={class:"text-gray-600 mb-4"};function W(o,e,n,r,i,s){const a=c("BaseButton");return l(),d("div",H,[e[2]||(e[2]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[3]||(e[3]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Error Loading Data",-1)),t("p",U,m(n.message),1),p(a,{variant:"primary",onClick:e[0]||(e[0]=g=>o.$emit("retry"))},{default:x(()=>e[1]||(e[1]=[t("i",{class:"fas fa-redo mr-2"},null,-1),h("Try Again ")])),_:1,__:[1]})])}const q=u(Z,[["render",W],["__scopeId","data-v-731a13f4"]]),G={name:"PeriodizationCard",props:{periodization:{type:Object,required:!0}},emits:["view","delete"],methods:{formatDate(o){return new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}}},J={class:"flex justify-between items-start mb-4"},K={class:"text-xl font-bold text-gray-800"},Q={class:"flex space-x-2"},X={class:"mb-6"},Y={class:"flex justify-between items-center mb-2"},ee={class:"text-sm font-bold text-gray-700"},te={class:"progress-bg rounded-full h-3"},oe={class:"flex justify-between items-center text-sm text-gray-500"},se={class:"flex items-center"},ne={class:"flex items-center"};function ie(o,e,n,r,i,s){return l(),d("div",{class:"periodization-card rounded-xl p-6 cursor-pointer relative",onClick:e[1]||(e[1]=a=>o.$emit("view",n.periodization.PERIODIZATION_ID))},[t("div",J,[t("h3",K,m(n.periodization.PERIODIZATION_NAME),1),t("div",Q,[t("button",{onClick:e[0]||(e[0]=j(a=>o.$emit("delete",n.periodization.PERIODIZATION_ID),["stop"])),class:"delete-button"},e[2]||(e[2]=[t("i",{class:"fas fa-trash"},null,-1)]))])]),t("div",X,[t("div",Y,[e[3]||(e[3]=t("span",{class:"text-sm font-semibold text-gray-700"},"Napredek",-1)),t("span",ee,m(n.periodization.progress)+"%",1)]),t("div",te,[t("div",{class:"progress-fill rounded-full h-3 transition-all duration-500",style:E({width:n.periodization.progress+"%"})},null,4)])]),t("div",oe,[t("div",se,[e[4]||(e[4]=t("i",{class:"fas fa-user mr-2"},null,-1)),t("span",null,m(n.periodization.ATHLETE_NAME),1)]),t("div",ne,[e[5]||(e[5]=t("i",{class:"fas fa-calendar mr-1"},null,-1)),t("span",null,m(s.formatDate(n.periodization.DATE_CREATED)),1)])])])}const re=u(G,[["render",ie],["__scopeId","data-v-d4699881"]]),ae={name:"EmptyState",components:{BaseButton:z},emits:["create"]},le={class:"empty-state rounded-xl p-12 text-center"};function ce(o,e,n,r,i,s){const a=c("BaseButton");return l(),d("div",le,[e[2]||(e[2]=t("i",{class:"fas fa-calendar-plus text-6xl text-gray-400 mb-4"},null,-1)),e[3]||(e[3]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Ni najdenih ciklizacij.",-1)),e[4]||(e[4]=t("p",{class:"text-gray-500 mb-6"},"Ustvari prvo ciklizacijo, da začneš.",-1)),p(a,{variant:"primary",onClick:e[0]||(e[0]=g=>o.$emit("create"))},{default:x(()=>e[1]||(e[1]=[t("i",{class:"fas fa-plus mr-2 text-sm"},null,-1),h("Ustvari ciklizacijo ")])),_:1,__:[1]})])}const de=u(ae,[["render",ce],["__scopeId","data-v-a6949152"]]),ue={name:"FloatingActionButton",emits:["click"]};function me(o,e,n,r,i,s){return l(),d("button",{onClick:e[0]||(e[0]=a=>o.$emit("click")),class:"floating-add-button fixed bottom-6 right-6 w-16 h-16 bg-green-500 hover:bg-green-600 text-white rounded-full shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center",style:{"z-index":"1000"}},e[1]||(e[1]=[t("i",{class:"fas fa-plus text-xl"},null,-1)]))}const pe=u(ue,[["render",me],["__scopeId","data-v-cbac37ce"]]),fe={name:"TrainerDashboardView",components:{TrainerHeader:D,WelcomeSection:O,LoadingSpinner:V,ErrorMessage:q,PeriodizationCard:re,EmptyState:de,FloatingActionButton:pe,AppAlert:N},data(){return{periodizations:[],loading:!0,error:null}},computed:{userFullName(){const o=JSON.parse(localStorage.getItem("user")||"{}");return`${o.first_name} ${o.last_name}`||"Trainer"}},methods:{async fetchPeriodizations(){var o,e,n;this.loading=!0,this.error=null;try{const r=await w.get("/users/trainer/periodizations");this.periodizations=r.data.periodizations.map(i=>{const s=this.calculateProgress(i.DATE_CREATED,i.END_DATE);return{...i,progress:s}})}catch(r){console.error("Napaka pri pridobivanju ciklizacij:",r),((o=r.response)==null?void 0:o.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||"Napaka pri nalaganju ciklizacij."}finally{this.loading=!1}},calculateProgress(o,e){const n=new Date(o),r=new Date(e),i=new Date,s=r.getTime()-n.getTime(),a=i.getTime()-n.getTime();return a<0?0:a>s?100:Math.round(a/s*100)},viewPeriodization(o){this.$router.push(`/periodization-info/${o}`)},createPeriodization(){this.$router.push("/trainer/create-periodization")},async deletePeriodization(o){var e,n,r,i;if(confirm("Želiš res izbrisati ciklizacijo?"))try{const s=localStorage.getItem("access_token");if(!s){this.$router.push("/login");return}const a=await axios.delete(`${I.LOGIN.replace("/auth/login","")}/users/trainer/delete-periodization`,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},data:{periodization_id:o}});this.showAlert?this.showAlert("success",a.data.message||"Ciklizacija uspešno izbrisana"):alert(a.data.message||"Ciklizacija uspešno izbrisana"),await this.fetchPeriodizations()}catch(s){console.error("Error deleting periodization:",s),this.showAlert?this.showAlert("error",((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"Napaka pri brisanju ciklizacije"):alert(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.message)||"Napaka pri brisanju ciklizacije")}},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchPeriodizations()}},ge={class:"min-h-screen content-bg"},_e={class:"container mx-auto px-4 py-6"},xe={key:2,class:"space-y-6"};function he(o,e,n,r,i,s){const a=c("TrainerHeader"),g=c("WelcomeSection"),v=c("LoadingSpinner"),$=c("ErrorMessage"),y=c("PeriodizationCard"),b=c("EmptyState"),k=c("FloatingActionButton");return l(),d("div",ge,[p(a,{"user-full-name":s.userFullName,onLogout:s.logout},null,8,["user-full-name","onLogout"]),t("main",_e,[p(g),i.loading?(l(),f(v,{key:0,message:"Nalaganje ciklizacij ..."})):i.error?(l(),f($,{key:1,message:i.error,onRetry:s.fetchPeriodizations},null,8,["message","onRetry"])):(l(),d("div",xe,[(l(!0),d(S,null,T(i.periodizations,_=>(l(),f(y,{key:_.PERIODIZATION_ID,periodization:_,onView:s.viewPeriodization,onDelete:ze=>s.deletePeriodization(_.PERIODIZATION_ID)},null,8,["periodization","onView","onDelete"]))),128)),i.periodizations.length===0?(l(),f(b,{key:0,onCreate:s.createPeriodization},null,8,["onCreate"])):A("",!0)]))]),p(k,{onClick:s.createPeriodization},null,8,["onClick"])])}const Ie=u(fe,[["render",he],["__scopeId","data-v-35122c35"]]);export{Ie as default};
