import{a as I,A as D}from"./api-BJgnF3hB.js";import{T as M}from"./TrainerHeader-DWaHe2Wg.js";import{A as O}from"./AppAlert-jdCgL8S3.js";import{_ as N,c as n,e as v,b as u,f as x,a as e,t as i,d as E,k as j,n as _,l as A,m as y,F as f,j as g,o as r}from"./index-CZfNrfaq.js";const S={name:"MicrocycleInfoView",components:{TrainerHeader:M,AppAlert:O},data(){return{loading:!0,error:null,microcycleInfo:null,selectedDayOfWeek:1,showModal:!1,selectedExercise:{},headerMounted:!1,alert:{show:!1,type:"info",message:""}}},computed:{userFullName(){const a=JSON.parse(localStorage.getItem("user")||"{}");return`${a.first_name} ${a.last_name}`||"Trainer"},microcycleId(){return this.$route.params.microcycleId},formattedExerciseDate(){var t;if(!((t=this.microcycleInfo)!=null&&t.methods)||this.microcycleInfo.methods.length===0)return"Ni datuma";const a=this.microcycleInfo.methods[0];return a.exercises&&a.exercises.length>0?new Date(a.exercises[0].exercise_date).toLocaleDateString("sl-SI",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"No Date"}},methods:{showAlert(a,t){this.alert={show:!0,type:a,message:t}},async fetchMicrocycleInfo(){var a,t,m;this.headerMounted||(this.loading=!0),this.error=null;try{const c=localStorage.getItem("access_token");if(!c){this.$router.push("/login");return}const s=await I.get(`${D.LOGIN.replace("/auth/login","")}/users/trainer/microcycle-info/${this.microcycleId}/${this.selectedDayOfWeek}`,{headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"}});this.microcycleInfo=s.data.microcycle_info,this.headerMounted||(this.headerMounted=!0)}catch(c){console.error("Napaka pri pridobivanju mikrocikla:",c),((a=c.response)==null?void 0:a.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((m=(t=c.response)==null?void 0:t.data)==null?void 0:m.message)||"Napaka pri nalaganju informacij o mikrociklu."}finally{this.loading=!1}},onDayChange(){this.loading=!0,this.fetchMicrocycleInfo()},previousDay(){this.selectedDayOfWeek>1&&(this.selectedDayOfWeek=this.selectedDayOfWeek-1,this.loading=!0,this.fetchMicrocycleInfo())},nextDay(){this.selectedDayOfWeek<7&&(this.selectedDayOfWeek=this.selectedDayOfWeek+1,this.loading=!0,this.fetchMicrocycleInfo())},showExerciseInfo(a){this.selectedExercise=a,this.showModal=!0},closeModal(){this.showModal=!1,this.selectedExercise={}},editExercise(a){this.showAlert("Info","Funkcionalnost za urejanje bo narejena v kratkem.")},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.$route.params.dayOfWeek&&(this.selectedDayOfWeek=parseInt(this.$route.params.dayOfWeek)),this.fetchMicrocycleInfo()}},C={class:"min-h-screen microcycle-bg"},W={key:0,class:"flex items-center justify-center min-h-screen"},V={key:1,class:"flex items-center justify-center min-h-screen"},T={class:"text-center bg-white rounded-xl p-8 mx-4"},P={class:"text-gray-600 mb-4"},B={key:2,class:"container mx-auto px-4 py-6"},F={class:"exercise-date-header rounded-xl p-6 mb-6"},L={class:"flex items-center justify-between"},z={class:"flex items-center space-x-6"},H={class:"flex items-center space-x-3"},R={class:"text-2xl font-bold text-white"},J={class:"flex items-center space-x-3"},U=["disabled"],K=["disabled"],G={key:0,class:"flex items-center text-white"},X={class:"exercises-table rounded-xl overflow-hidden"},q={class:"exercise-rows"},Q={class:"col-span-1 flex justify-center"},Y=["checked"],Z={class:"col-span-3 flex items-center space-x-2"},$={class:"exercise-name"},ee=["onClick"],te={class:"col-span-1 text-center parameter-value"},se={class:"col-span-1 text-center parameter-value"},oe={class:"col-span-1 text-center parameter-value"},ae={class:"col-span-1 text-center parameter-value"},ie={class:"col-span-1 text-center parameter-value"},le={class:"col-span-1 text-center parameter-value"},ne={class:"col-span-1 text-center"},re={class:"method-group-badge"},ce={class:"col-span-1 flex justify-center"},de=["onClick"],me={key:0,class:"empty-state"},ue={key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},fe={class:"modal-content max-w-2xl w-full max-h-[80vh] overflow-y-auto"},pe={class:"flex justify-between items-start mb-4"},he={class:"modal-title"},ve={class:"exercise-details"},xe={class:"detail-row"},_e={class:"detail-value"},ye={class:"detail-row"},ge={class:"detail-value"},ke={class:"exercise-description"},be={class:"description-text"};function we(a,t,m,c,s,l){var p,h;const k=x("TrainerHeader"),b=x("AppAlert");return r(),n("div",C,[v(k,{"user-full-name":l.userFullName,onLogout:l.logout},null,8,["user-full-name","onLogout"]),s.loading&&!s.headerMounted?(r(),n("div",W,t[7]||(t[7]=[e("div",{class:"text-center"},[e("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"}),e("p",{class:"text-white text-lg"},"Nalaganje mikrocikla...")],-1)]))):s.error&&!s.headerMounted?(r(),n("div",V,[e("div",T,[t[9]||(t[9]=e("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),t[10]||(t[10]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Napaka pri nalaganju mikrocikla",-1)),e("p",P,i(s.error),1),e("button",{onClick:t[0]||(t[0]=(...o)=>l.fetchMicrocycleInfo&&l.fetchMicrocycleInfo(...o)),class:"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition duration-200"},t[8]||(t[8]=[e("i",{class:"fas fa-redo mr-2"},null,-1),E("Poskusi ponovno ")]))])])):(r(),n("div",B,[e("div",F,[e("div",L,[e("div",z,[e("div",H,[t[11]||(t[11]=e("i",{class:"fas fa-calendar text-2xl text-white"},null,-1)),e("h1",R,i(l.formattedExerciseDate),1)]),e("div",J,[e("button",{onClick:t[1]||(t[1]=o=>l.previousDay()),disabled:s.selectedDayOfWeek<=1,class:_(["nav-button",{"opacity-50 cursor-not-allowed":s.selectedDayOfWeek<=1}])},t[12]||(t[12]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),10,U),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.selectedDayOfWeek=o),onChange:t[3]||(t[3]=(...o)=>l.onDayChange&&l.onDayChange(...o)),class:"day-select-inline"},t[13]||(t[13]=[y('<option value="1" data-v-c3641e31>Ponedeljek</option><option value="2" data-v-c3641e31>Torek</option><option value="3" data-v-c3641e31>Sreda</option><option value="4" data-v-c3641e31>Četrtek</option><option value="5" data-v-c3641e31>Petek</option><option value="6" data-v-c3641e31>Sobota</option><option value="7" data-v-c3641e31>Nedelja</option>',7)]),544),[[A,s.selectedDayOfWeek]]),e("button",{onClick:t[4]||(t[4]=o=>l.nextDay()),disabled:s.selectedDayOfWeek>=7,class:_(["nav-button",{"opacity-50 cursor-not-allowed":s.selectedDayOfWeek>=7}])},t[14]||(t[14]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),10,K)])]),s.loading&&s.headerMounted?(r(),n("div",G,t[15]||(t[15]=[e("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),e("span",null,"Nalaganje...",-1)]))):u("",!0)])]),e("div",X,[t[19]||(t[19]=y('<div class="table-header grid grid-cols-12 gap-4 p-4" data-v-c3641e31><div class="col-span-1" data-v-c3641e31></div><div class="col-span-3 text-center font-semibold text-white" data-v-c3641e31>VAJA</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>SERIJE</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>PONOVITVE</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>OBREMENITEV %</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>VO2 MAX</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>HR %</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>POČITEK</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>SKUPINA</div><div class="col-span-1 text-center font-semibold text-white" data-v-c3641e31>UREDI</div></div>',1)),e("div",q,[(r(!0),n(f,null,g(((p=s.microcycleInfo)==null?void 0:p.methods)||[],o=>(r(),n(f,{key:o.method_id},[(r(!0),n(f,null,g(o.exercises,d=>(r(),n("div",{key:d.exercise_id,class:"exercise-row grid grid-cols-12 gap-4 p-4 items-center hover:bg-white/10 transition duration-200"},[e("div",Q,[e("input",{type:"checkbox",checked:d.exercise_finished,class:"exercise-checkbox",disabled:""},null,8,Y)]),e("div",Z,[e("span",$,i(d.exercise_name),1),e("button",{onClick:w=>l.showExerciseInfo(d),class:"info-button"},t[16]||(t[16]=[e("i",{class:"fas fa-info-circle"},null,-1)]),8,ee)]),e("div",te,i(o.method_parameters.sets||"/"),1),e("div",se,i(o.method_parameters.repetitions||"/"),1),e("div",oe,i(o.method_parameters.burden_percentage_of_mvc?o.method_parameters.burden_percentage_of_mvc+" %":"/"),1),e("div",ae,i(o.method_parameters.vo2_max?o.method_parameters.vo2_max+" %":"/"),1),e("div",ie,i(o.method_parameters.hr_percentage?o.method_parameters.hr_percentage+" %":"/"),1),e("div",le,i((Math.floor(o.method_parameters.rest_seconds/60)!==0?Math.floor(o.method_parameters.rest_seconds/60)+" min ":"")+(o.method_parameters.rest_seconds%60!==0?o.method_parameters.rest_seconds%60+" s":"")||"/"),1),e("div",ne,[e("span",re,i(o.method_group),1)]),e("div",ce,[e("button",{onClick:w=>l.editExercise(d),class:"edit-button"},t[17]||(t[17]=[e("i",{class:"fas fa-edit"},null,-1)]),8,de)])]))),128))],64))),128))]),!((h=s.microcycleInfo)!=null&&h.methods)||s.microcycleInfo.methods.length===0?(r(),n("div",me,t[18]||(t[18]=[e("div",{class:"text-center py-12"},[e("i",{class:"fas fa-dumbbell text-4xl text-white/50 mb-4"}),e("h3",{class:"text-xl font-bold text-white mb-2"},"Na vaj."),e("p",{class:"text-white/80"},"Na ta dan ni predvidena nobena vaja.")],-1)]))):u("",!0)])])),s.showModal?(r(),n("div",ue,[e("div",fe,[e("div",pe,[e("h1",he,i(s.selectedExercise.exercise_name),1),e("button",{onClick:t[5]||(t[5]=(...o)=>l.closeModal&&l.closeModal(...o)),class:"modal-close"},t[20]||(t[20]=[e("i",{class:"fas fa-times"},null,-1)]))]),e("div",ve,[e("div",xe,[t[21]||(t[21]=e("span",{class:"detail-label"},"Težavnost:",-1)),e("span",_e,i(s.selectedExercise.difficulty)+"/10",1)]),e("div",ye,[t[22]||(t[22]=e("span",{class:"detail-label"},"Video:",-1)),e("span",ge,i(s.selectedExercise.video_url!=="/"?"Available":"Not Available"),1)])]),e("div",ke,[t[23]||(t[23]=e("h3",{class:"description-title"},"Opis",-1)),e("p",be,i(s.selectedExercise.description),1)])])])):u("",!0),v(b,{visible:s.alert.show,type:s.alert.type,message:s.alert.message,onClose:t[6]||(t[6]=o=>s.alert.show=!1)},null,8,["visible","type","message"])])}const Ne=N(S,[["render",we],["__scopeId","data-v-c3641e31"]]);export{Ne as default};
