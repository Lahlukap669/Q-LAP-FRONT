import{a as x,A as h}from"./api-BJgnF3hB.js";import{T as D}from"./TrainerHeader-DWaHe2Wg.js";import{_ as u,c as d,a as t,o as l,t as m,e as p,w as z,f as c,d as $,g as j,h as A,i as f,b as E,F as T,j as S}from"./index-CZfNrfaq.js";import{B as v}from"./BaseButton-B1l1TnMm.js";import{A as N}from"./AppAlert-jdCgL8S3.js";const P={name:"WelcomeSection"},C={class:"welcome-section rounded-xl p-8 mb-8"};function B(s,e,n,r,i,o){return l(),d("div",C,e[0]||(e[0]=[t("h2",{class:"text-3xl font-bold text-white mb-2"}," Trener, dobrodošel nazaj! ",-1),t("p",{class:"text-white/90 text-lg"}," Upravljaj s svojimi ciklizacijami in spremljaj napredek špotnikov. ",-1)]))}const O=u(P,[["render",B],["__scopeId","data-v-8b5bf9b4"]]),R={name:"LoadingSpinner",props:{message:{type:String,default:"Nalaganje..."}}},L={class:"text-center py-12"},F={class:"text-white text-lg"};function M(s,e,n,r,i,o){return l(),d("div",L,[e[0]||(e[0]=t("i",{class:"fas fa-spinner fa-spin text-4xl text-white mb-4"},null,-1)),t("p",F,m(n.message),1)])}const V=u(R,[["render",M]]),Z={name:"ErrorMessage",components:{BaseButton:v},props:{message:{type:String,required:!0}},emits:["retry"]},H={class:"error-card rounded-xl p-8 text-center"},U={class:"text-gray-600 mb-4"};function W(s,e,n,r,i,o){const a=c("BaseButton");return l(),d("div",H,[e[2]||(e[2]=t("i",{class:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"},null,-1)),e[3]||(e[3]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2"},"Error Loading Data",-1)),t("p",U,m(n.message),1),p(a,{variant:"primary",onClick:e[0]||(e[0]=g=>s.$emit("retry"))},{default:z(()=>e[1]||(e[1]=[t("i",{class:"fas fa-redo mr-2"},null,-1),$("Try Again ")])),_:1,__:[1]})])}const q=u(Z,[["render",W],["__scopeId","data-v-82f814a7"]]),G={name:"PeriodizationCard",props:{periodization:{type:Object,required:!0}},emits:["view","delete"],methods:{formatDate(s){return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}}},J={class:"flex justify-between items-start mb-4"},K={class:"text-xl font-bold text-gray-800"},Q={class:"flex space-x-2"},X={class:"mb-6"},Y={class:"flex justify-between items-center mb-2"},ee={class:"text-sm font-bold text-gray-700"},te={class:"progress-bg rounded-full h-3"},oe={class:"flex justify-between items-center text-sm text-gray-500"},se={class:"flex items-center"},ne={class:"flex items-center"};function re(s,e,n,r,i,o){return l(),d("div",{class:"periodization-card rounded-xl p-6 cursor-pointer relative",onClick:e[1]||(e[1]=a=>s.$emit("view",n.periodization.PERIODIZATION_ID))},[t("div",J,[t("h3",K,m(n.periodization.PERIODIZATION_NAME),1),t("div",Q,[t("button",{onClick:e[0]||(e[0]=j(a=>s.$emit("delete",n.periodization.PERIODIZATION_ID),["stop"])),class:"delete-button"},e[2]||(e[2]=[t("i",{class:"fas fa-trash"},null,-1)]))])]),t("div",X,[t("div",Y,[e[3]||(e[3]=t("span",{class:"text-sm font-semibold text-gray-700"},"Napredek",-1)),t("span",ee,m(n.periodization.progress)+"%",1)]),t("div",te,[t("div",{class:"progress-fill rounded-full h-3 transition-all duration-500",style:A({width:n.periodization.progress+"%"})},null,4)])]),t("div",oe,[t("div",se,[e[4]||(e[4]=t("i",{class:"fas fa-user mr-2"},null,-1)),t("span",null,m(n.periodization.ATHLETE_NAME),1)]),t("div",ne,[e[5]||(e[5]=t("i",{class:"fas fa-calendar mr-1"},null,-1)),t("span",null,m(o.formatDate(n.periodization.DATE_CREATED)),1)])])])}const ie=u(G,[["render",re],["__scopeId","data-v-f6730205"]]),ae={name:"EmptyState",components:{BaseButton:v},emits:["create"]},le={class:"empty-state rounded-xl p-12 text-center"};function ce(s,e,n,r,i,o){const a=c("BaseButton");return l(),d("div",le,[e[2]||(e[2]=t("i",{class:"fas fa-calendar-plus text-6xl text-gray-400 mb-4"},null,-1)),e[3]||(e[3]=t("h3",{class:"text-xl font-bold text-gray-700 mb-2"},"Ni najdenih ciklizacij.",-1)),e[4]||(e[4]=t("p",{class:"text-gray-500 mb-6"},"Ustvari prvo ciklizacijo, da začneš.",-1)),p(a,{variant:"primary",onClick:e[0]||(e[0]=g=>s.$emit("create"))},{default:z(()=>e[1]||(e[1]=[t("i",{class:"fas fa-plus mr-2 text-sm"},null,-1),$("Ustvari ciklizacijo ")])),_:1,__:[1]})])}const de=u(ae,[["render",ce],["__scopeId","data-v-4cd81c88"]]),ue={name:"FloatingActionButton",emits:["click"]};function me(s,e,n,r,i,o){return l(),d("button",{onClick:e[0]||(e[0]=a=>s.$emit("click")),class:"floating-add-button fixed bottom-6 right-6 w-16 h-16 bg-green-500 hover:bg-green-600 text-white rounded-full shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center",style:{"z-index":"1000"}},e[1]||(e[1]=[t("i",{class:"fas fa-plus text-xl"},null,-1)]))}const pe=u(ue,[["render",me],["__scopeId","data-v-73537b7f"]]),fe={name:"TrainerDashboardView",components:{TrainerHeader:D,WelcomeSection:O,LoadingSpinner:V,ErrorMessage:q,PeriodizationCard:ie,EmptyState:de,FloatingActionButton:pe,AppAlert:N},data(){return{periodizations:[],loading:!0,error:null}},computed:{userFullName(){const s=JSON.parse(localStorage.getItem("user")||"{}");return`${s.first_name} ${s.last_name}`||"Trainer"}},methods:{async fetchPeriodizations(){var s,e,n;this.loading=!0,this.error=null;try{const r=localStorage.getItem("access_token");if(!r){this.$router.push("/login");return}const i=await x.get(`${h.TRAINER_PERIODIZATIONS}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});this.periodizations=i.data.periodizations.map(o=>{const a=this.calculateProgress(o.DATE_CREATED,o.END_DATE);return{...o,progress:a}})}catch(r){console.error("Napaka pri pridobivanju ciklizacij:",r),((s=r.response)==null?void 0:s.status)===401?(localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")):this.error=((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||"Napaka pri nalaganju ciklizacij."}finally{this.loading=!1}},calculateProgress(s,e){const n=new Date(s),r=new Date(e),i=new Date,o=r.getTime()-n.getTime(),a=i.getTime()-n.getTime();return a<0?0:a>o?100:Math.round(a/o*100)},viewPeriodization(s){this.$router.push(`/periodization-info/${s}`)},createPeriodization(){this.$router.push("/trainer/create-periodization")},async deletePeriodization(s){var e,n,r,i;if(confirm("Želiš res izbrisati ciklizacijo?"))try{const o=localStorage.getItem("access_token");if(!o){this.$router.push("/login");return}const a=await x.delete(`${h.LOGIN.replace("/auth/login","")}/users/trainer/delete-periodization`,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},data:{periodization_id:s}});this.showAlert?this.showAlert("success",a.data.message||"Ciklizacija uspešno izbrisana"):alert(a.data.message||"Ciklizacija uspešno izbrisana"),await this.fetchPeriodizations()}catch(o){console.error("Error deleting periodization:",o),this.showAlert?this.showAlert("error",((n=(e=o.response)==null?void 0:e.data)==null?void 0:n.message)||"Napaka pri brisanju ciklizacije"):alert(((i=(r=o.response)==null?void 0:r.data)==null?void 0:i.message)||"Napaka pri brisanju ciklizacije")}},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("user"),this.$router.push("/login")}},mounted(){if(!localStorage.getItem("access_token")){this.$router.push("/login");return}this.fetchPeriodizations()}},ge={class:"min-h-screen content-bg"},_e={class:"container mx-auto px-4 py-6"},xe={key:2,class:"space-y-6"};function he(s,e,n,r,i,o){const a=c("TrainerHeader"),g=c("WelcomeSection"),y=c("LoadingSpinner"),b=c("ErrorMessage"),k=c("PeriodizationCard"),I=c("EmptyState"),w=c("FloatingActionButton");return l(),d("div",ge,[p(a,{"user-full-name":o.userFullName,onLogout:o.logout},null,8,["user-full-name","onLogout"]),t("main",_e,[p(g),i.loading?(l(),f(y,{key:0,message:"Nalaganje ciklizacij ..."})):i.error?(l(),f(b,{key:1,message:i.error,onRetry:o.fetchPeriodizations},null,8,["message","onRetry"])):(l(),d("div",xe,[(l(!0),d(T,null,S(i.periodizations,_=>(l(),f(k,{key:_.PERIODIZATION_ID,periodization:_,onView:o.viewPeriodization,onDelete:ze=>o.deletePeriodization(_.PERIODIZATION_ID)},null,8,["periodization","onView","onDelete"]))),128)),i.periodizations.length===0?(l(),f(I,{key:0,onCreate:o.createPeriodization},null,8,["onCreate"])):E("",!0)]))]),p(w,{onClick:o.createPeriodization},null,8,["onClick"])])}const Ie=u(fe,[["render",he],["__scopeId","data-v-e53d4615"]]);export{Ie as default};
